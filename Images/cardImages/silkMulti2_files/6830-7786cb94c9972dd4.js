"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6830],{13210:function(e,t,r){r.d(t,{a:function(){return c}});var n=r(27573),s=r(7653),l=r(7609),a=r(16105),i=r(41225),o=r(43456),u=r(14507);let c=e=>{let{setUpgradeModalParams:t}=(0,u.i)();return(0,s.useEffect)(()=>()=>{t({upgradeablePlanNames:o.M,isOpen:!0})},[t]),(0,n.jsx)(l.zx,{...e,onClick:()=>{localStorage.setItem(i.F.ADD_TO_CART_CTA,a.ZH.CONCURRENT_GENERATION),t({upgradeablePlanNames:o.M,isOpen:!0})},children:"Upgrade"})}},10275:function(e,t,r){r.d(t,{a:function(){return u},m:function(){return c}});var n=r(27573),s=r(7653),l=r(96771),a=r(86678);let i=e=>{let{id:t,systemMessage:r,temperature:n,initialMessages:l=[],contextWindow:i=9}=e,[o,u]=(0,s.useState)(!1),[c,d]=(0,s.useState)(t),[m,x]=(0,s.useState)([]),[p,f]=(0,s.useState)(),[h,g]=(0,s.useState)(null),[v,j]=(0,s.useState)(null),b=(0,s.useMemo)(()=>i%2==0?i+1:i,[i]),w=(0,s.useRef)(new AbortController),y=(0,s.useCallback)(e=>{let{newMessages:t,replace:r=!1}=e;x(e=>r?t:[...e,...t])},[]);c!==t&&(y({newMessages:l,replace:!0}),u(!1),f(void 0),g(null),j(null),d(t),w.current.abort());let N=(0,s.useCallback)(async(e,t)=>{u(!0),j(null),w.current.abort(),w.current=new AbortController;let s={id:(0,a.Ox)(),content:"",role:"assistant",model:t};f(s);try{let t=await (0,a.XY)({id:c,messages:e,systemMessage:r,temperature:n,controller:w.current}),l=await (0,a.LZ)({reader:t,currentMessage:s,setCurrentMessage:f,setCurrentToolStatus:g,controller:w.current});if(!l.content)throw Error("Message response is empty");y({newMessages:[l],replace:!1})}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;j(e instanceof Error?e.message:"An error occurred while sending the message")}finally{f(void 0),u(!1)}},[c,r,n,y]),T=(0,s.useCallback)(async(e,t)=>{let r=[...m,{...e}];y({newMessages:r,replace:!0}),await N(r.slice(-b),t)},[m,y,N,b]),k=(0,s.useCallback)(()=>{w.current.abort(),u(!1),p&&p.content?y({newMessages:[p],replace:!1}):y({newMessages:[],replace:!1}),f(void 0)},[p,y]),I=(0,s.useCallback)(async(e,t)=>{let r=m.at(e-1);if(!r||"user"!==r.role)return;let n={id:(0,a.Ox)(),content:r.content,role:"user",model:t},s=[...m.slice(0,e-1),n];y({newMessages:s,replace:!0}),await N(s.slice(-b),t)},[m,y,N,b]),C=(0,s.useCallback)(async(e,t)=>{let r=m.slice(0,e+1);r[r.length-1].model=t,y({newMessages:r,replace:!0}),await N(r.slice(-b),t)},[m,y,N,b]),O=(0,s.useCallback)(async(e,t)=>{if(o)return;let r=m.find(t=>t.id===e);if(!r)return;let n=m.findIndex(t=>t.id===e);"assistant"===r.role?await I(n,t):"user"===r.role&&await C(n,t)},[o,m,I,C]);return{id:c,messages:p?[...m,p]:[...m],loading:o,stopMessage:k,sendMessage:T,currentToolStatus:h,error:v,regenerateMessage:O,appendMessages:y}},o=(0,s.createContext)(void 0),u=e=>{var t;let{children:r}=e,{model:u,id:c}=(0,l.w)(),[d,m]=(0,s.useState)(!1),x=(0,s.useRef)({}),p=null!==(t=x.current[c])&&void 0!==t?t:[],{messages:f,loading:h,sendMessage:g,stopMessage:v,regenerateMessage:j,error:b,id:w}=i({id:c,systemMessage:d?u.caption_intent:u.intent,initialMessages:p,contextWindow:u.context_window,temperature:u.temperature});f.length&&(x.current[w]=f);let y=(0,s.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r={id:(0,a.Ox)(),model:u.id,role:"user",content:[{type:"text",text:e},...t]};await g(r,u.id)},[g,u.id]),N=(0,s.useMemo)(()=>({id:w,messages:f,loading:h,sendMessage:y,stopMessage:v,regenerateMessage:j,setIsUsedForCaption:m,isUsedForCaption:d,error:b}),[f,h,w,b]);return(0,n.jsx)(o.Provider,{value:N,children:r})},c=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useChatContext must be used within a ChatProvider");return e}},80646:function(e,t,r){r.r(t),r.d(t,{SidebarProvider:function(){return u},useSidebarContext:function(){return c}});var n=r(27573),s=r(26066),l=r(81695),a=r(7653),i=r(65535);let o=a.createContext(void 0),u=e=>{let{children:t,cookieKey:r,isSidebarOpenDefault:u}=e,c="true"===(0,l.useSearchParams)().get(i.l$.REDIRECTED_FROM_ASSETS),[d,m]=a.useState(u||c),x=(0,a.useCallback)(()=>{m(e=>!e)},[]);(0,a.useEffect)(()=>{s.Z.set(r,"".concat(d))},[d,r]);let p=(0,a.useMemo)(()=>({isSidebarOpen:d,toggleSidebar:x}),[d,x]);return(0,n.jsx)(o.Provider,{value:p,children:t})},c=()=>{let e=a.useContext(o);if(void 0===e)throw Error("useSidebarContext must be used within a SidebarProvider");return e}},84751:function(e,t,r){r.d(t,{CodeBlockHeader:function(){return u}});var n=r(27573),s=r(7653),l=r(8699),a=r(10665),i=r(7609),o=r(11965);let u=e=>{let{language:t,code:r}=e,[,u]=(0,l.m9)(),[c,d]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(c){let e=setTimeout(()=>{d(!1)},3e3);return()=>clearTimeout(e)}return()=>{}},[c]),(0,n.jsxs)("div",{className:"flex w-full max-w-[588px] items-center justify-between rounded-t-xl p-4 font-medium transition-all duration-500",children:[(0,n.jsx)("p",{className:"font-medium",children:t}),c?(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.K,{className:"size-4"}),(0,n.jsx)("span",{className:"",children:"Copied!"})]}):(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.zx,{variant:"ghost-secondary",size:"icon-sm",className:"size-4 p-0",onClick:()=>{d(!0),u(r)},children:(0,n.jsx)(a.d$2,{className:"size-4"})}),(0,n.jsx)("span",{children:"Copy code"})]})]})}},1963:function(e,t,r){r.d(t,{X:function(){return eU}});var n,s,l,a,i=r(27573),o=r(18113),u=r(7653),c=r(93351),d=r(41270),m=r(72075);(n=l||(l={})).PROMPT="prompt",n.IMAGE="image",n.CROPPED_IMAGE="croppedImage",n.MIME_TYPE="mimeType";let x=d.z.object({prompt:m.Pp.optional(),image:m.KA.optional(),croppedImage:m.KA.optional(),mimeType:m.KA.optional()}),p=e=>{let{children:t}=e,r=(0,c.cI)({resolver:(0,o.F)(x),defaultValues:{prompt:"",image:null,croppedImage:null,mimeType:null}});return(0,i.jsx)(c.RV,{...r,children:t})},f=()=>{let e=(0,c.Gc)();if(!e)throw Error("useImagineBotFormContext must be used within a ImagineBotFormProvider");return(0,u.useMemo)(()=>({formHook:e}),[e])};var h=r(1315),g=r(26393),v=r(54375);(s=a||(a={})).TextToImageSidebar="text-to-image-sidebar",s.TextToImageModels="text-to-image-models",s.TextToImageStyles="text-to-image-styles",s.TextToImageAspectRatio="text-to-image-aspect-ratio",s.TextToVideoSidebar="text-to-video-sidebar",s.TextToVideoModels="text-to-video-models",s.TextToVideoStyles="text-to-video-styles",s.TextToVideoAspectRatio="text-to-video-aspect-ratio";var j=r(10275),b=r(68255),w=r(8699),y=r(97499);let N=e=>{let{text:t,onStart:r=()=>{},onComplete:n=()=>{}}=e,[s,l]=(0,u.useState)(""),[a,i]=(0,u.useState)(0);return(0,u.useEffect)(()=>{if(a<t.length){r();let e=setTimeout(()=>{l(e=>e+t[a]),i(e=>e+1)},10);return()=>clearTimeout(e)}return n(),()=>{}},[a,t]),s};var T=r(47630),k=r(96170),I=r(59598),C=r(15456),O=r(9736),_=r(84751);let E={h1:e=>{let{children:t,...r}=e;return(0,i.jsx)("h1",{...r,className:"mb-2 text-4xl font-semibold",children:t})},h2:e=>{let{children:t,...r}=e;return(0,i.jsx)("h2",{...r,className:"mb-2 text-2xl font-semibold",children:t})},h3:e=>{let{children:t,...r}=e;return(0,i.jsx)("h3",{...r,className:"mb-2 text-xl font-semibold",children:t})},h4:e=>{let{children:t,...r}=e;return(0,i.jsx)("h4",{...r,className:"mb-2 text-base font-semibold",children:t})},h5:e=>{let{children:t,...r}=e;return(0,i.jsx)("h5",{...r,className:"mb-2 text-base font-semibold",children:t})},h6:e=>{let{children:t,...r}=e;return(0,i.jsx)("h6",{...r,className:"mb-2 text-base font-normal",children:t})},p:e=>{let{children:t,className:r,...n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{...n,className:(0,b.cn)(r,"inline text-sm font-normal"),children:t}),(0,i.jsx)("div",{className:"mb-2"})]})},pre:e=>{let{children:t,className:r,...n}=e;return(0,i.jsx)("pre",{...n,className:(0,b.cn)(r,"mb-3 w-full text-sm"),children:t})},em:e=>{let{children:t,...r}=e;return(0,i.jsx)("em",{...r,className:"text-sm font-normal italic",children:t})},strong:e=>{let{children:t,...r}=e;return(0,i.jsx)("strong",{...r,className:"text-sm font-bold",children:t})},code(e){let{node:t,className:r,children:n,...s}=e,l=/language-(\w+)/.exec(r||""),a=String(n).replace(/\n$/,"");return l?(0,i.jsxs)("div",{className:"flex w-full max-w-[350px] flex-col items-center gap-0",children:[(0,i.jsx)(_.CodeBlockHeader,{language:l[1],code:a}),(0,i.jsx)(C.Z,{customStyle:{margin:0,width:"100%",backgroundColor:"#000000"},className:"rounded-b-xl",style:O.Z,language:l[1],wrapLines:!0,children:a})]}):(0,i.jsx)("code",{...s,className:r,children:n})},ul:e=>{let{children:t,className:r,...n}=e;return(0,i.jsx)("ul",{...n,className:(0,b.cn)(r,"mb-2 flex list-inside list-disc flex-col gap-2"),children:t})},ol:e=>{let{children:t,className:r,...n}=e;return(0,i.jsx)("ol",{...n,className:(0,b.cn)(r,"mb-2 flex list-inside list-decimal flex-col gap-2 [&_li_p]:ml-1"),children:t})},li:e=>{let{children:t,className:r,...n}=e;return(0,i.jsx)("li",{...n,className:(0,b.cn)(r,"text-base font-normal"),children:t})},a:e=>{let{children:t,...r}=e;return(0,i.jsx)("a",{...r,className:"text-base text-primary-61 transition-all duration-500 hover:underline",children:t})}},S=e=>{let{sender:t,content:r,image:n}=e,s=!!n;return"user"===t&&s?(0,i.jsx)("div",{className:"flex items-center justify-center rounded-2xl bg-neutral-21 p-2 dark:bg-neutral-81",children:(0,i.jsx)("img",{src:n,alt:"User uploaded",className:"aspect-square h-full w-[200px] rounded-lg object-contain"})}):"assistant"===t?(0,i.jsx)("div",{className:"flex w-[235px] items-start self-stretch p-3",children:(0,i.jsx)(T.D,{remarkPlugins:[I.Z],rehypePlugins:[k.Z],components:E,className:"w-full",children:r})}):(0,i.jsx)("div",{className:"flex max-w-[270px] items-center self-stretch rounded-2xl bg-neutral-21 px-3.5 py-2.5 dark:bg-neutral-81",children:(0,i.jsx)("div",{className:"w-full max-w-[270px] overflow-auto text-wrap break-words",children:(0,i.jsx)("p",{className:"text-sm text-neutral-101 dark:text-neutral-white",children:r})})})};var M=r(10665),A=r(7609),P=r(6847);let R=e=>{let{handleCopy:t,handleGenerate:r=()=>{},credits:n=0}=e;return(0,i.jsxs)("div",{className:"flex items-center justify-between self-stretch border-t border-neutral-21 px-3 py-2 dark:border-neutral-81",children:[(0,i.jsxs)(P.D,{isLoading:!1,children:[(0,i.jsx)(P.D.Button,{btnText:"Generate",credits:n,onClick:r}),(0,i.jsx)(P.D.Cancel,{handleCancel:()=>{}})]}),(0,i.jsx)(A.zx,{variant:"ghost-secondary",size:"icon-xl",onClick:t,children:(0,i.jsx)(M.d$2,{className:"size-6 stroke-[2]"})})]})},z=()=>(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2.5 rounded-lg p-3 ring-1 ring-neutral-21 dark:ring-neutral-81",children:[(0,i.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-41 [animation-duration:1.5s] dark:bg-neutral-71"}),(0,i.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-41 [animation-delay:100ms] [animation-duration:1.5s] dark:bg-neutral-71"}),(0,i.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-41 [animation-delay:200ms] [animation-duration:1.5s] dark:bg-neutral-71"}),(0,i.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-41 [animation-delay:300ms] [animation-duration:1.5s] dark:bg-neutral-71"})]}),B=e=>{let{image:t,sender:r,content:n,suggestedPrompt:s,credits:l,handleGenerate:a=()=>{},showPromptCTAs:o=!0,showLoading:u=!1}=e,[,c]=(0,w.m9)(),d="user"===r,m="assistant"===r;return(0,i.jsx)("div",{className:(0,b.cn)("flex w-full max-w-[366px] items-start gap-3",{"justify-end":d,"justify-start":m}),children:d?(0,i.jsx)(S,{sender:r,image:t,content:n}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex size-[30px] items-center justify-center rounded-xl bg-neutral-21 text-neutral-101 dark:bg-neutral-white dark:text-neutral-101",children:(0,i.jsx)(y.Z,{className:"size-4/5"})}),u?(0,i.jsx)(z,{}):(0,i.jsxs)("div",{className:"flex w-[283px] flex-col items-start rounded-2xl ring-1 ring-neutral-21 dark:ring-neutral-81",children:[(0,i.jsx)(S,{sender:r,image:t,content:n}),o&&(0,i.jsx)(R,{handleCopy:()=>{c(null!=s?s:n)},credits:l,handleGenerate:()=>a(null!=s?s:n)})]})]})})},F=e=>(0,i.jsx)(B,{...e}),L=e=>{let{content:t,onStart:r,onComplete:n,...s}=e,l=N({text:t,onStart:r,onComplete:n});return(0,i.jsx)(B,{content:l.replace(/<prompt>|<\/prompt>/gm,""),...s})};L.displayName="ChatMessageWithTypewriter",B.displayName="ChatMessageRoot",F.displayName="ChatMessageDefault";let D={Default:F,Typewriter:L},G=e=>{if("string"!=typeof e)return null;let t=/<prompt>(.*?)<\/prompt>/gm.exec(e);return t?t[1].trim():null};var V=e=>{let{messages:t,isLoading:r=!1,handleGenerate:n,credits:s,isFirstTimeRender:l}=e,[a,o]=(0,u.useState)(!1),c=(0,u.useRef)(t.length),d=(0,u.useRef)(null),m=(0,u.useRef)(!1);return(0,u.useEffect)(()=>{if(!m.current){var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"instant"}),m.current=!0}},[]),(0,u.useEffect)(()=>{if(m.current){var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},[t]),(0,u.useEffect)(()=>{let e;if(m.current){if(a)e=setInterval(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},500);else{var t;null===(t=d.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}}return()=>{clearTimeout(e)}},[a]),(0,i.jsxs)("div",{className:(0,b.cn)("flex flex-col items-end gap-4 self-stretch"),children:[t.map((e,u)=>{let d="assistant"===e.role,m=u===t.length-1&&d,x="user"===e.role&&!!e.content.find(e=>"image_url"===e.type),p=m&&!x&&(l||t.length>c.current),f=G(e.content);if(p)return(0,i.jsx)(D.Typewriter,{content:e.content,suggestedPrompt:f,sender:e.role,onStart:()=>{o(!0)},onComplete:()=>{o(!1)},showPromptCTAs:!a&&!!f,showLoading:r,credits:s,handleGenerate:n},e.id);if(d)return(0,i.jsx)(D.Default,{sender:e.role,content:e.content,suggestedPrompt:f,handleGenerate:n,credits:s,showPromptCTAs:!!f},e.id);let h=e.content.find(e=>"image_url"===e.type);if(h)return(0,i.jsx)(D.Default,{sender:e.role,content:"",image:null==h?void 0:h.file_url.url},e.id);let g=e.content.find(e=>"text"===e.type);return(0,i.jsx)(D.Default,{sender:e.role,content:null==g?void 0:g.text},e.id)}),(0,i.jsx)("div",{ref:d})]})},U=r(94904);let Z=(e,t)=>{if(t<=0||0===e.length)return[];let r=[...e];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r.slice(0,Math.min(t,e.length))};var H=r(57872),X=r(96771);let q=e=>{let{title:t,intent:r,onClick:n}=e;return(0,i.jsx)("button",{type:"button",className:"flex shrink-0 rounded-full bg-neutral-white p-2 pl-3 text-xs ring-1 ring-inset ring-neutral-31 transition-colors duration-500 hover:bg-neutral-21 dark:bg-neutral-91 dark:ring-neutral-81 dark:hover:bg-neutral-81",onClick:()=>n(r),children:t})},K=()=>{let{presets:e}=(0,X.w)(),t=!!(0,U.useUserStoreContext)()(e=>e.user),r=(0,H.w)(),{sendMessage:n}=(0,j.m)(),s=(0,u.useMemo)(()=>Z(e,4),[e]),l=e=>{if(!t){r();return}n(e)};return(0,i.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-2",children:s.map(e=>(0,i.jsx)(q,{title:e.title,intent:e.intent,onClick:()=>l(e.intent)},e.title))})},W=()=>(0,i.jsxs)("div",{className:"flex flex-col items-center gap-6 self-stretch",children:[(0,i.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl bg-neutral-21 text-neutral-101 dark:text-neutral-101",children:(0,i.jsx)(y.Z,{className:"size-6"})}),(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 self-stretch",children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-neutral-101 dark:text-neutral-white",children:"Imagine Bot"}),(0,i.jsx)("p",{className:"text-center text-sm text-neutral-71 dark:text-neutral-41",children:"Spark your creativity with Imagine Bot! Generate unique prompts to inspire your next visual masterpiece."})]})]}),Q=()=>{let{formHook:e}=f(),t=(0,c.qo)({control:e.control,name:"image"});return(0,i.jsxs)("div",{className:"m-auto flex flex-col items-center gap-2 self-stretch",children:[(0,i.jsx)(W,{}),!t&&(0,i.jsx)(K,{})]})},Y=e=>{let{handleGenerateImage:t,credits:r}=e,{messages:n,loading:s}=(0,j.m)(),l=(0,u.useRef)(!1);return 0===n.length?(l.current=!0,(0,i.jsx)(Q,{})):(0,i.jsx)(V,{isLoading:s,messages:n,handleGenerate:t,credits:r,isFirstTimeRender:l.current})};var $=r(46793);let J=e=>{let{title:t}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex h-[39px] shrink-0 items-center py-1 pl-3 pr-2",children:(0,i.jsx)("span",{className:"text-sm",children:t})}),(0,i.jsx)($.i,{orientation:"horizontal",className:"w-full",variant:"v3"})]})},ee=e=>{let{children:t}=e;return(0,i.jsx)("div",{className:"scrollbar__alt flex flex-1 flex-col items-center justify-between self-stretch overflow-auto p-3",children:t})},et=e=>{let{children:t}=e;return(0,i.jsx)("div",{className:"shrink-0 border-t border-neutral-21 p-3 dark:border-neutral-81",children:t})};J.displayName="ImagineBotLayoutHeader",ee.displayName="ImagineBotLayoutBody",et.displayName="ImagineBotLayoutFooter";var er=r(8289),en=r(14671),es=r(90244),el=r(11473),ea=r(96836),ei=r(35350),eo=r(86678),eu=r(58414),ec=r(27185),ed=r(1319),em=r(31170),ex=r(30629),ep=r(89226),ef=r(64711);let eh=new ep.h({baseURL:ef.v.NEXT_PUBLIC_UPLOADS_API_URL}),eg=new AbortController,ev=async e=>{eg.signal.aborted&&(eg=new AbortController);let t=new FormData;e.forEach(e=>{t.append("files",e,e.name)});let{data:r}=await eh.post("/chatly/chat/upload",{body:t,signal:eg.signal},{throwOnError:!0});return r},ej=()=>{eg.abort()},eb=async e=>ev(e.files),ew=()=>{let e=(0,ex.useMutation)({mutationFn:eb}),t=(0,u.useCallback)(()=>{e.isLoading&&ej()},[e.isLoading]);return Object.assign(e,{cancelRequest:t})};var ey=r(809),eN=r(67728);let eT=ed.TOOLS_SETTINGS.ASPECT_RATIO_SVI.content,ek=e=>{let{hide:t=!1}=e,{formHook:r}=f(),{setIsUsedForCaption:n}=(0,j.m)(),s=ew(),{setShowDropZone:a}=(0,ey.p)(),o=(0,c.qo)({control:r.control,name:"image"}),u=(0,c.qo)({control:r.control,name:"croppedImage"}),d=async e=>{a(!1);let t=await (0,eN.Ll)(e,"file"),i=await s.mutateAsync({files:[t]});n(!0),r.setValue(l.MIME_TYPE,t.type),r.setValue(l.IMAGE,i["".concat(t.name)]),r.setValue(l.CROPPED_IMAGE,i["".concat(t.name)])};return s.isLoading&&!o?(0,i.jsx)("div",{className:"mr-2",children:(0,i.jsx)(ec.Spinner,{className:"size-6 text-primary-61 dark:text-primary-51"})}):(0,i.jsx)(em.Q,{aspectRatios:Object.values(eT),uploadImgPromptVariant:"icon",uploadImgPromptSize:"icon",handleAddImage:d,currentImage:u,handleDeleteImage:()=>{r.setValue(l.IMAGE,null),r.setValue(l.CROPPED_IMAGE,null)},imageCroppedFrom:o,showCompactViewLoading:s.isLoading,selectedImagePromptVariant:"v2",selectedImageClassName:"dark:bg-neutral-81 bg-neutral-21 h-[192px] rounded-2xl",showCropButton:!1,disableAutoUpload:!0,uploadImgPromptClassName:(0,b.cn)("mr-2",{"w-0 transition-all duration-300 h-0 opacity-0 scale-0 mr-0":t})})};var eI=r(81682);let eC=e=>{let{onFocus:t=()=>{},onBlur:r=()=>{}}=e,{formHook:n}=f(),{setIsUsedForCaption:s}=(0,j.m)(),l=e=>{if("Enter"===e.key&&!e.shiftKey){var t,r;e.preventDefault(),null===(r=e.currentTarget)||void 0===r||null===(t=r.form)||void 0===t||t.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}};return(0,i.jsx)(c.Qr,{control:n.control,name:"prompt",render:e=>{let{field:{ref:n,onBlur:a,...o}}=e;return(0,i.jsx)(eI.Z,{placeholder:"Type your idea...",className:(0,b.cn)("w-full resize-none rounded-[10px] border-none bg-neutral-11 py-2.5 pl-3 pr-2 text-sm text-neutral-101 placeholder-neutral-61 outline-none !ring-primary-61 transition-all duration-300 hover:bg-neutral-21 focus:bg-neutral-11 focus:ring-1 dark:bg-neutral-81 dark:text-neutral-white dark:placeholder-neutral-51 dark:ring-primary-51 dark:hover:bg-neutral-71 dark:focus:bg-neutral-81"),minRows:1,maxRows:4,ref:n,onKeyDown:l,onBlur:()=>{a(),r()},onFocus:()=>{t(),s(!1)},autoFocus:!1,...o})}})},eO=()=>{let[e,t]=(0,u.useState)(!1),r=(0,H.w)(),{formHook:n}=f(),{sendMessage:s,loading:a}=(0,j.m)(),o=!!(0,U.useUserStoreContext)()(e=>e.user),{aggregator:d}=(0,eu.O)(),{page:m,source:x,userStatus:p,userPlan:h,userPlanPeriod:g}=(0,ei.T)(),v=(0,c.qo)({control:n.control,name:"image"}),b=(0,c.qo)({control:n.control,name:"prompt"}),w=(0,c.qo)({control:n.control,name:"mimeType"});return(0,i.jsxs)("form",{className:"flex flex-1 items-center justify-center",onSubmit:n.handleSubmit(e=>{if(!o){r();return}if(!e[l.PROMPT]&&!e[l.IMAGE]){en.Am.error("Please enter a prompt or an image");return}d.log(es.H0.click.withProperties({page_name:m,source:x,variant:ea.x.TEXT_IMAGE_V2,user_account_status:p,user_plan:h,user_plan_period:g,trigger:el.U.AI_BOT_GENERATE})),v?s("Generate Prompt for this Image",[{id:(0,eo.Ox)(),name:"Image",mimetype:w,type:"image_url",file_url:{url:v}}]):s(e.prompt||""),n.reset()}),children:[!b&&(0,i.jsx)(ek,{hide:e}),!v&&(0,i.jsx)(eC,{onFocus:()=>{t(!0)},onBlur:()=>{t(!1)}}),(0,i.jsx)(A.zx,{type:"submit",variant:"primary",size:"icon-xl",className:"ml-2 shrink-0 disabled:bg-neutral-81 disabled:text-neutral-white",disabled:!v&&!b||a,children:(0,i.jsx)(er.Rr,{className:"size-6 stroke-[1.5]"})})]})};var e_=r(62351),eE=r(24162),eS=r(82633),eM=r(46329),eA=r(50294);let eP=e=>{let{src:t,className:r,wrapperClassName:n,alt:s,spinnerClassName:l}=e,[a,o]=(0,u.useState)(!0);return(0,i.jsxs)("div",{className:(0,b.cn)("relative size-full",n),children:[a&&(0,i.jsx)("div",{className:(0,b.cn)("absolute inset-0 flex items-center justify-center"),children:(0,i.jsx)(ec.Spinner,{className:(0,b.cn)("size-5",l)})}),(0,i.jsx)(eA.default,{fill:!0,src:t,className:(0,b.cn)("object-cover object-center",r),onLoad:()=>o(!1),alt:s})]})};var eR=r(87447);let ez=e=>{let{handleTryNow:t,lightAssetUrl:r,darkAssetUrl:n}=e,s=(0,eR.e)();return(0,i.jsxs)("div",{className:"flex w-[280px] flex-col items-center rounded-2xl bg-neutral-91 p-2 pb-3 dark:bg-neutral-white",children:[(0,i.jsx)("div",{className:"h-[148px] w-full overflow-hidden rounded-lg bg-neutral-81 dark:bg-neutral-21",children:(0,i.jsx)(eP,{src:s?n:r,alt:"Imagine bot"})}),(0,i.jsxs)("div",{className:"flex flex-col items-start gap-2 self-stretch px-1 py-2 pb-4",children:[(0,i.jsx)("h4",{className:"font-semibold text-neutral-white dark:text-neutral-101",children:"Imagine Bot"}),(0,i.jsx)("p",{className:"text-xs text-neutral-41 dark:text-neutral-71",children:"Refine your ideas and write detailed prompts using Imagine Bot"})]}),(0,i.jsx)("div",{className:"flex items-center justify-end self-stretch px-1",children:(0,i.jsx)(A.zx,{size:"xs",type:"button",variant:"inverted-primary",onClick:t,children:"Try Now"})})]})},eB=e=>{let{children:t,handleOnClose:r,lightAssetUrl:n,darkAssetUrl:s}=e,{isFirstTimeTooltipOpen:l,setIsFirstTimeTooltipOpen:a,setIsOpen:o}=(0,g.u)(e=>({setIsOpen:e.setIsOpen,isFirstTimeTooltipOpen:e.isFirstTimeTooltipOpen,setIsFirstTimeTooltipOpen:e.setIsFirstTimeTooltipOpen})),c=(0,u.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),r(),o(!0)},[r,o]);return(0,u.useEffect)(()=>{a(!0)},[a]),(0,i.jsx)(eM.fX,{content:(0,i.jsx)(ez,{lightAssetUrl:n,darkAssetUrl:s,handleTryNow:c}),genericTooltipProps:{open:l,disableHoverableContent:!1},genericTooltipContentProps:{className:"p-0 bg-transparent dark:bg-transparent rounded-none border-none ring-0 shadow-none",align:"end",onPointerDownOutside:()=>{r()}},arrowProps:{show:!0},children:t})},eF=e=>{let{children:t,isBotOpen:r}=e;return(0,i.jsx)(eM.fX,{content:"Imagine Bot",genericTooltipProps:{open:!r&&void 0},children:t})},eL=e=>{let{children:t,...r}=e;return r.shouldShowFirstTimeTooltip?(0,i.jsx)(eB,{lightAssetUrl:r.lightAssetUrl,darkAssetUrl:r.darkAssetUrl,handleOnClose:r.handleOnClose,children:t}):(0,i.jsx)(eF,{isBotOpen:r.isBotOpen,children:t})},eD=u.forwardRef((e,t)=>{let{className:r,tooltipProps:n,...s}=e,l=(0,U.useUserStoreContext)()(e=>e.user),{toggleOpen:a,isOpen:o,setIsFirstTimeTooltipOpen:c,isFirstTimeTooltipOpen:d}=(0,g.u)(e=>({toggleOpen:e.toggleOpen,isOpen:e.isOpen,setIsFirstTimeTooltipOpen:e.setIsFirstTimeTooltipOpen,isFirstTimeTooltipOpen:e.isFirstTimeTooltipOpen})),{mutate:m}=(0,eS.yH)(),x=(0,eE.T)(e_.o.HAS_SEEN_IMAGINE_BOT_FIRST_TIME_TOOLTIP),p=(0,u.useCallback)(()=>{m({name:e_.o.HAS_SEEN_IMAGINE_BOT_FIRST_TIME_TOOLTIP,status:!0}),c(!1)},[m,c]);return(0,i.jsx)(A.zx,{...s,type:"button",ref:t,variant:"none",size:"none",className:"pointer-events-auto active:translate-y-0",onClick:a,children:(0,i.jsx)(eL,{isBotOpen:o,shouldShowFirstTimeTooltip:!!l&&!x&&d,handleOnClose:p,...n,children:(0,i.jsxs)("div",{className:(0,b.cn)("flex size-[60px] items-center justify-center rounded-2xl bg-neutral-white p-3.5 shadow-[0px_10px_20px_0px_rgba(0,0,0,0.05)] transition-transform duration-300 dark:bg-neutral-91",{"hover:scale-[1.06] active:scale-[0.8]":!d},r),children:[(0,i.jsx)(y.Z,{className:(0,b.cn)("absolute size-8 opacity-100 transition-all duration-300",{"rotate-180 scale-0 opacity-0":o})}),(0,i.jsx)(M.KQD,{className:(0,b.cn)("absolute size-8 -rotate-180 opacity-0 transition-all duration-300",{"rotate-0 opacity-100":o})})]})})})});eD.displayName="ImagineBotTriggerCTA";let eG=Object.values(a).map(e=>".".concat(e)),eV=e=>{let{handleGenerateImage:t,credits:r,botCtaProps:n}=e,{isOpen:s,setIsOpen:l}=(0,g.u)(e=>({isOpen:e.isOpen,setIsOpen:e.setIsOpen}));return(0,u.useEffect)(()=>()=>{l(!1)},[l]),(0,i.jsxs)(h.A6,{open:s,onOpenChange:l,children:[(0,i.jsx)(h.mu,{asChild:!0,children:(0,i.jsx)(eD,{...n})}),(0,i.jsxs)(h.nE,{variant:"v2",className:"z-20 flex h-[560px] w-[357px] flex-col rounded-[18px]",align:"end",side:"top",sideOffset:8,onInteractOutside:e=>{eG.some(t=>(0,v.Ni)(e,t))&&e.preventDefault()},children:[(0,i.jsx)(h.S8,{className:"right-2 top-1"}),(0,i.jsx)(J,{title:"Imagine Bot"}),(0,i.jsx)(ee,{children:(0,i.jsx)(Y,{handleGenerateImage:t,credits:r})}),(0,i.jsx)(et,{children:(0,i.jsx)(eO,{})})]})]})},eU=e=>(0,i.jsx)(p,{children:(0,i.jsx)(eV,{...e})})},96771:function(e,t,r){r.d(t,{w:function(){return i}});var n=r(81695),s=r(42636),l=r(36962);let a={[s.H7.TEXT_TO_IMAGE]:"textToImage",[s.H7.TEXT_TO_VIDEO]:"textToVideo"},i=()=>{var e,t;let r=(0,l.Td)()(e=>e.imagineBotConfig),s=(0,n.usePathname)();return Object.assign(null!==(e=r[a[s]])&&void 0!==e?e:r.textToImage,{id:null!==(t=a[s])&&void 0!==t?t:"notFound"})}},80014:function(e,t,r){r.d(t,{i:function(){return i}});var n=r(7653),s=r(23611),l=r(36962),a=r(94183);let i=()=>{var e;let t=(0,l.Td)()(e=>e.subscriptionBasedAccessControl),{subscribedPriceItem:r}=(0,a.y)();return(0,n.useMemo)(()=>{var e,n;if(!t)return null;let l=t[null!==(n=null==r?void 0:null===(e=r.StripeProduct)||void 0===e?void 0:e.name)&&void 0!==n?n:s.Bg.FREE];return null!=l?l:null},[null==r?void 0:null===(e=r.StripeProduct)||void 0===e?void 0:e.name,t])}},87447:function(e,t,r){r.d(t,{e:function(){return s}});var n=r(54689);let s=()=>{let{theme:e,systemTheme:t}=(0,n.F)();return"system"===e?"dark"===t:"dark"===e}},86678:function(e,t,r){r.d(t,{Ox:function(){return u},XY:function(){return m},LZ:function(){return c}});var n=r(30857),s=r(71044);async function*l(e){let{isAborted:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new TextDecoder,n="";for(;;){if(null==t?void 0:t()){await e.cancel();break}let{value:s,done:l}=await e.read();if(l)break;let a=(n+=r.decode(s,{stream:!0})).indexOf("\n\n");for(;-1!==a;){let e=n.slice(0,a);for(let t of(n=n.slice(a+2),e.split("\n")))if(t.startsWith("data: ")){let e=JSON.parse(t.substring(6));yield e;break}a=n.indexOf("\n\n")}}}var a=r(64711);let i="vgpt-a1-1",o=a.v.IMAGINE_BOT_CHAT_URL+"/chatly/chat/completions",u=n.Z;async function c(e){var t,r;let{reader:n,currentMessage:s,setCurrentMessage:a,setCurrentToolStatus:o,controller:c}=e,d="";for await(let e of l(n))e.tool?o(e.content):(o(null),d+=e.content,s&&!c.signal.aborted&&a({...s,content:d}));return{id:null!==(t=null==s?void 0:s.id)&&void 0!==t?t:u(),content:d,role:"assistant",model:null!==(r=null==s?void 0:s.model)&&void 0!==r?r:i}}let d=e=>{let{id:t,messages:r,temperature:n,systemMessage:s}=e,l=new FormData,a=r.at(-1),o=r.map(e=>{if("assistant"===e.role)return{...e,model:i};let t=e.content.map(t=>{let r=e.id===a.id;return"file"===t.type?r?{type:"file",file_url:{url:t.file_url.url}}:null:"image_url"===t.type?{type:"image_url",file_url:{url:t.file_url.url}}:{type:"text",text:r?"[AI assistant system prompt to follow]\n".concat(s,"\n[End of system prompt]\n[User prompt]\n").concat(t.text):t.text}}).filter(e=>!!e);return{id:e.id,model:i,role:"user",content:t}});return l.append("data",JSON.stringify({id:t,temperature:n,model:a.model,messages:o})),l};async function m(e){let{id:t,messages:r,systemMessage:n,temperature:l,controller:a}=e,i=d({id:t,messages:r,systemMessage:n,temperature:l}),u=await fetch(o,{method:"POST",headers:{Authorization:s.X.getTokenManager().getBearerToken()},body:i,signal:a.signal});if(200!==u.status)throw Error(u.status.toString());if(!u.body)throw Error("Response body does not exist");return u.body.getReader()}},26393:function(e,t,r){r.d(t,{u:function(){return n}});let n=(0,r(57582).Ue)(e=>({isOpen:!1,setIsOpen:t=>e({isOpen:t}),open:()=>e({isOpen:!0}),toggleOpen:()=>e(e=>({isOpen:!e.isOpen})),isFirstTimeTooltipOpen:!1,setIsFirstTimeTooltipOpen:t=>e({isFirstTimeTooltipOpen:t})}))},809:function(e,t,r){r.d(t,{p:function(){return n}});let n=(0,r(57582).Ue)(e=>({showDropZone:!1,setShowDropZone:t=>e({showDropZone:t}),showImgCropModal:!1,setShowImgCropModal:t=>e({showImgCropModal:t}),baseImg:null,setBaseImg:t=>e({baseImg:t})}))},8289:function(e,t,r){r.d(t,{Rr:function(){return a},V_:function(){return l},nQ:function(){return s}});var n=r(27573);let s=e=>{let{width:t=8,height:r=7,className:s=""}=e;return(0,n.jsx)("svg",{className:s,width:t,height:r,fill:"none",viewBox:"0 0 8 7",children:(0,n.jsx)("path",{fill:"#999",fillRule:"evenodd",d:"M7.854.146a.5.5 0 010 .708l-5 5-.354.353-.354-.353-2-2a.5.5 0 11.708-.708L2.5 4.793 7.146.146a.5.5 0 01.708 0z",clipRule:"evenodd"})})},l=e=>{let{className:t}=e;return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",className:t,children:(0,n.jsx)("path",{d:"M3.5 8h9",stroke:"currentColor",strokeLinecap:"round"})})},a=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,n.jsx)("path",{d:"M9 14.25V3.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M3.75 9L9 3.75L14.25 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}}}]);