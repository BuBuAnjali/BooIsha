"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6552],{57046:function(e,t,n){n.d(t,{b:function(){return a}});let a={HAS_SEEN_IDEATE_ANNOUNCEMENT:"hasSeenIdeateAnnouncement",HAS_SEEN_ONBOARDING_SURVEY_MODAL:"hasSeenOnboardingSurveyModal",SHOW_IDEATE_FORM:"showIdeateForm",SHOW_PHOTO_GEN_FORM:"showPhotoGenForm",TEXT_TO_VIDEO_SIDEBAR:"textToVideoSidebar",TEXT_TO_IMAGE_SIDEBAR:"textToImageSidebar",HAS_SEEN_MODEL_TRAINING_ONBOARDING_MODAL:"hasSeenModelTrainingOnboardingModal",TEXT_TO_SPEECH_HISTORY_SIDEBAR:"textToSpeechHistorySidebar",VOICE_CLONING_HISTORY_SIDEBAR:"voiceCloningHistorySidebar"}},400:function(e,t,n){n.d(t,{C:function(){return a}});let a={DASHBOARD_GENERATE_BUTTON:"image-studio-generate-button",TEXT_TO_PNG:"text-to-png",FEED_RECREATE:"feed-recreate",TEXT_TO_MUSIC:"text-to-music"}},34196:function(e,t,n){n.d(t,{D:function(){return a}});let a={IDEATE_EXPORT_FORM:"wvqazd",CREATOR_PROGRAM_FORM:"mB8Dqe",IDEATE_CREATOR_PROGRAM_FORM:"3yprJ8",AUTOSHOTS_BETA_ACCESS_FORM:"wgJ75M",PHOTO_GEN_FEEDBACK_FORM:"3xRRqJ",STORYBOARD_FEEDBACK_FORM:"wvqazd",STORYBOARD_BETA_ACCESS_FORM:"mezeEQ"}},62351:function(e,t,n){n.d(t,{o:function(){return a}});let a={HAS_SEEN_DASHBOARD_ANNOUNCEMENT:"hasSeenDashboardAnnouncement",HAS_SEEN_EXPORT_ANNOUNCEMENT:"hasSeenExportAnnouncement",UNREAD_UPDATES_PAGE:"unreadUpdatesPage",HAS_SEEN_UPDATES_MODAL:"hasSeenUpdatesModal",HAS_AUTOSHOTS_BETA_ACCESS:"hasAutoshotsBetaAccess",HAS_SEEN_IMAGINE_BOT_FIRST_TIME_TOOLTIP:"hasSeenImagineBotFirstTimeTooltip",HAS_STORYBOARD_BETA_ACCESS:"hasStoryboardBetaAccess",SHOULD_NOTIFY_REWARD:"shouldNotifyReward",HAS_SEEN_IMAGE_FEEDBACK_MODAL:"hasSeenImageFeedbackModal",HAS_SEEN_VIDEO_FEEDBACK_MODAL:"hasSeenVideoFeedbackModal",HAS_DISABLED_TEXT_TO_VIDEO_CREDIT_CONSUMPTION_CONSENT_MODAL:"hasDisabledTextToVideoCreditConsumptionConsentModal",HAS_SEEN_ONBOARDING_PERSONA_MODAL:"hasSeenOnboardingPersonaModal"}},9384:function(e,t,n){n.d(t,{N:function(){return p},q:function(){return _}});var a=n(27573),r=n(7653),o=n(65740),i=n(13645),l=n(51233),s=n(32138),u=n(36962),c=n(86485),d=n(84474);let m=(0,r.createContext)(void 0),_=()=>{let e=(0,r.useContext)(m);if(!e)throw Error("useTextToImageCommunityModels must be used within a TextToImageCommunityModelsProvider");return e},p=e=>{let{children:t}=e,{filteredFinishedModels:n}=(0,l.h)(),{sortedModels:_}=(0,o.M)(),{favoriteModelsList:p}=(0,i.b)(),{modelTraining:{communityModels:E}}=(0,u.Td)()(e=>e.defaultSettings),g=(0,s.ic)(E.modelListId),T=(0,r.useMemo)(()=>({model_id:g.model_id,isPopular:E.isPopular,isPremium:E.isPremium,enable_hr:E.enable_hr,inf_time:E.inf_time,enable_layer_diffusion:E.enable_layer_diffusion,enable_adetailer:E.enable_adetailer,supported_control_modes:E.supported_control_modes}),[g,E]),S=(0,r.useMemo)(()=>null==n?void 0:n.map(e=>{var t,n;return{id:e.id,source:c.KS.USER,name:null!==(t=e.settings.name)&&void 0!==t?t:"Dummy Model",description:null!==(n=e.settings.description)&&void 0!==n?n:"Dummy Description",thumb:(0,d.q6)(e.url.thumbnail),sample_results:e.url.thumbnail&&e.url.thumbnail.length>4?e.url.thumbnail.slice(0,4):(0,d.QJ)(e.url.thumbnail,4),effect:e.uuid,is_community_model:!0,...T}}),[n,T]),f=(0,r.useMemo)(()=>null==_?void 0:_.map(e=>{var t,n;return{id:e.id,source:c.KS.COMMUNITY,name:null!==(t=e.settings.name)&&void 0!==t?t:"Dummy Model",description:null!==(n=e.settings.description)&&void 0!==n?n:"Dummy Description",thumb:(0,d.q6)(e.url.thumbnail),sample_results:e.url.thumbnail&&e.url.thumbnail.length>4?e.url.thumbnail.slice(0,4):(0,d.QJ)(e.url.thumbnail,4),effect:e.uuid,is_community_model:!0,...T}}),[_,T]),v=(0,r.useMemo)(()=>null==p?void 0:p.map(e=>{var t,n;return{id:e.id,source:c.KS.FAVORITE,name:null!==(t=e.settings.name)&&void 0!==t?t:"Dummy Model",description:null!==(n=e.settings.description)&&void 0!==n?n:"Dummy Description",thumb:(0,d.q6)(e.url.thumbnail),sample_results:e.url.thumbnail&&e.url.thumbnail.length>4?e.url.thumbnail.slice(0,4):(0,d.QJ)(e.url.thumbnail,4),effect:e.uuid,is_community_model:!0,...T}}),[p,T]),h=(0,r.useMemo)(()=>[...S,...f,...v],[S,f,v]),O=(0,r.useMemo)(()=>({communityModels:h}),[h]);return(0,a.jsx)(m.Provider,{value:O,children:t})}},49590:function(e,t,n){n.d(t,{LI:function(){return i},dk:function(){return M},X5:function(){return o},S3:function(){return c}});var a=n(27573),r=n(68255);let o="rounded-lg p-1 text-neutral-white hover:bg-neutral-white/[0.24] size-7",i=e=>{let{children:t,className:n}=e;return(0,a.jsx)("div",{className:(0,r.cn)("absolute inline-flex flex-col items-center justify-center gap-1 rounded-lg bg-black/[0.34] p-1 opacity-0 backdrop-blur-sm transition-all duration-500 group-hover:opacity-100",n),children:t})};var l=n(7653),s=n(79525),u=n(27185);let c=e=>{let{variant:t="skeleton",className:n,style:o}=e;return"spinner"===t?(0,a.jsx)("div",{className:(0,r.cn)("flex size-full items-center justify-center rounded bg-neutral-21 dark:bg-neutral-101",n),style:o,children:(0,a.jsx)(u.Spinner,{className:"size-16 border-4 text-primary"})}):(0,a.jsx)("div",{className:(0,r.cn)("size-full animate-pulse rounded bg-neutral-11 dark:bg-neutral-81",n),style:o})};var d=n(10665),m=n(7609),_=n(46329),p=n(89463),E=n(29738),g=n(34196),T=n(62351),S=n(9384),f=n(33757),v=n(87811),h=n(20786),O=n(32138),A=n(66266),I=n(19011);let b="rounded-md p-0.5 text-neutral-white bg-black/[0.34] backdrop-blur-[6px] hover:bg-black/[0.24] size-6",N=e=>{let{id:t,image:n,isFailed:o,isLoading:i,isTransparent:u,aspectRatio:d,handleFullView:m,loaderVariant:_,children:p,FailedComponent:E}=e,[g,T]=d.split(":"),[S,f]=(0,l.useState)(!1);return o?(0,a.jsx)(E,{}):i?(0,a.jsx)(c,{variant:_,className:"h-auto w-full rounded-lg dark:bg-neutral-91",style:{aspectRatio:"".concat(g,"/").concat(T)}}):(0,a.jsxs)("div",{id:t,className:(0,r.cn)("group relative isolate flex w-full shrink-0 rounded-lg",{[s.y]:u,"bg-neutral-21 dark:bg-neutral-91":!u}),style:{aspectRatio:"".concat(g,"/").concat(T)},children:[(0,a.jsx)("img",{alt:t,src:n,onLoad:()=>f(!0),onError:()=>f(!0),loading:"lazy",className:(0,r.cn)("size-full rounded-lg object-cover transition-all duration-100",{"opacity-0":!S,"opacity-100":S})}),(0,a.jsx)("div",{className:(0,r.cn)("pointer-events-none absolute inset-0 z-10 rounded-lg bg-neutral-21 transition-opacity dark:bg-neutral-91",{"opacity-100":!S,"opacity-0":S}),children:(0,a.jsx)("div",{className:(0,r.cn)("z-10 size-full rounded-lg bg-neutral-41 transition-all [animation-duration:1500ms] dark:bg-neutral-71",{"animate-pulse":!S})})}),(0,a.jsx)("button",{type:"button",onClick:m,"aria-label":"Open Full View",className:"absolute inset-0"}),p]})},y=l.memo(e=>{let{id:t,image:n,children:o,className:i,loaderVariant:l,handleFullView:s,isLoading:u=!1,aspectRatio:c,isTransparent:d,isFailed:m,FailedComponent:_,...p}=e;return(0,a.jsx)("div",{className:(0,r.cn)("group relative isolate mb-1 size-full w-full break-inside-avoid overflow-hidden rounded",i),...p,children:(0,a.jsx)(N,{id:t,image:n,isFailed:m,isLoading:u,isTransparent:d,aspectRatio:c,handleFullView:s,loaderVariant:l,FailedComponent:_,children:o})})});y.displayName="GeneratedImage.Root";let M={Root:y,VariateIcon:e=>{let{className:t}=e;return(0,a.jsx)("div",{className:(0,r.cn)("absolute right-0 top-0 rounded-bl-lg bg-black/[0.24] p-1 text-neutral-white opacity-100 transition-all duration-500 group-hover:opacity-0",t),children:(0,a.jsx)(d.lwj,{className:"size-5 stroke-[1.5]"})})},ToolbarButtons:e=>{var t,n,r;let{image:o,onDownload:i,handleEditImage:l,handleEditPrompt:s,handleSingleRecreate:c,isRecreating:N}=e,y=o.settings.metadata,M=(0,O.ic)(Number(null!==(r=null==y?void 0:null===(t=y.remoteConfig)||void 0===t?void 0:t.modelListId)&&void 0!==r?r:-1)),{communityModels:R}=(0,S.q)(),C=(null==y?void 0:null===(n=y.recreateInfo)||void 0===n?void 0:n.isCommunityModel)?R.find(e=>{var t;return e.effect===(null==y?void 0:null===(t=y.remoteConfig)||void 0===t?void 0:t.modelListId)}):M,{downloadImage:D}=(0,v._)({image:o,model:C}),{getDescription:x}=(0,h.F)(o),w=async()=>{let e=x();await D({description:e}),(0,I.m)(g.D.PHOTO_GEN_FEEDBACK_FORM)},G=(0,f.X)({announcementFlag:T.o.HAS_SEEN_EXPORT_ANNOUNCEMENT,variant:A.Z.EXPORT});return(0,a.jsxs)("div",{className:"absolute inset-x-0 bottom-0 flex w-full items-center justify-between p-2 opacity-0 group-hover:opacity-100",children:[(0,a.jsx)(_.fX,{content:"Download",genericTooltipContentProps:{side:"bottom"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",className:b,onClick:async()=>{await w(),null==i||i(),G()},children:[(0,a.jsx)(d.v9M,{className:"size-5 stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Download"})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.fX,{content:"Edit",genericTooltipContentProps:{side:"bottom"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",onClick:l,className:b,children:[(0,a.jsx)(p.d,{className:"size-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Edit"})]})}),(0,a.jsx)(_.fX,{content:"Recreate",genericTooltipContentProps:{side:"bottom"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",onClick:c,className:b,disabled:N,children:[N?(0,a.jsx)(u.Spinner,{className:"size-4"}):(0,a.jsx)(E.D,{className:"size-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Recreate"})]})}),(0,a.jsx)(_.fX,{content:"Edit prompt",genericTooltipContentProps:{side:"bottom"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",onClick:s,className:b,children:[(0,a.jsx)(d.UVU,{className:"size-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Edit prompt"})]})})]})]})},InteractionButtons:e=>{let{handleLike:t,handleDislike:n}=e;return(0,a.jsxs)(i,{className:"left-2 top-2",children:[(0,a.jsx)(_.fX,{content:"Like",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",onClick:t,className:o,children:[(0,a.jsx)(d.lbB,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Like"})]})}),(0,a.jsx)(_.fX,{content:"Dislike",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",onClick:n,className:o,children:[(0,a.jsx)(d.kZ9,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Dislike"})]})})]})},ManipulationButtons:e=>{let{handleUpscale:t,handleImageVariate:n,isUpscaled:l=!1,isImageVariateBtn:s=!0}=e;return(0,a.jsxs)(i,{className:"bottom-2 right-2",children:[(0,a.jsx)(_.fX,{content:l?"Upscaled":"Upscale",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.zx,{size:"none",onClick:t,variant:l?"primary":"none",className:(0,r.cn)(o,{"bg-primary-61 hover:bg-primary-71/100 focus:bg-primary-61":l}),children:[(0,a.jsx)(d.yWA,{className:"stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Upscale"})]})}),s&&(0,a.jsx)(_.fX,{content:"Variate",genericTooltipContentProps:{side:"left"},children:(0,a.jsxs)(m.zx,{size:"none",variant:"none",className:o,onClick:n,children:[(0,a.jsx)(d.lwj,{className:"size-6 stroke-[1.5]"}),(0,a.jsx)("span",{className:"sr-only",children:"Variate"})]})})]})},OriginalImageThumbnail:e=>{let{image:t,className:n,handleClick:o}=e;return(0,a.jsxs)("div",{tabIndex:0,role:"button",onClick:o,onKeyDown:o,className:(0,r.cn)("group/og-image absolute bottom-2 left-2 overflow-hidden rounded-lg border border-neutral-white/[0.24] opacity-0 transition-all duration-500 group-hover:opacity-100",n),children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-black/60 opacity-0 transition-all duration-500 group-hover/og-image:opacity-100",children:(0,a.jsx)("span",{className:"text-base font-normal text-neutral-white",children:"Original"})}),t&&(0,a.jsx)("img",{src:t,alt:"Original",className:"size-full rounded-lg object-cover"})]})},HighlightLabel:e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"absolute left-2 top-2 flex items-center justify-center gap-1 rounded-lg bg-black/[0.34] px-2 py-1 backdrop-blur-sm",children:(0,a.jsx)("span",{className:"text-center text-sm font-medium text-neutral-white",children:t})})}}},33757:function(e,t,n){n.d(t,{X:function(){return m}});var a=n(7653),r=n(94904),o=n(15218),i=n(62351),l=n(82633),s=n(69517),u=n(66266),c=n(36962),d=n(24162);let m=e=>{let{announcementFlag:t,variant:n}=e,m=(0,d.T)(t),_=(0,c.Td)()(e=>e.announcementModal)[n],{mutate:p}=(0,l.yH)(),E=(0,s.u)(e=>e.setIsOpen),g=(0,r.useUserStoreContext)()(e=>e.subscription),{isSubscriptionActive:T}=(0,o.L1)(g);return(0,a.useCallback)(()=>{(null==_?void 0:_.is_enabled)&&(null==_?void 0:_.should_use_trigger)&&!m&&!T&&(E(!0,i.o.HAS_SEEN_EXPORT_ANNOUNCEMENT===t?u.Z.EXPORT:u.Z.DASHBOARD),p({name:t,status:!0}))},[t,null==_?void 0:_.is_enabled,null==_?void 0:_.should_use_trigger,m,T,E,p])}},87811:function(e,t,n){n.d(t,{_:function(){return O}});var a=n(7653),r=n(24752),o=n(94904),i=n(50499),l=n(14671),s=n(90244),u=n(41225),c=n(76820),d=n(80317),m=n(33339),_=n(35350),p=n(21741),E=n(28821),g=n(75555),T=n(71133),S=n(58414),f=n(19924),v=n(84474),h=n(24995);let O=e=>{let{image:t,triggerPoint:n,model:O}=e,A=(0,o.useUserStoreContext)()(e=>e.user),{incrementExports:I}=(0,p.X)(),{data:b}=(0,c.jE)(),{aggregator:N}=(0,S.O)(),{page:y,source:M,userStatus:R,userPlan:C,userPlanPeriod:D}=(0,_.T)(),{download:x}=(0,d.dY)(),{generationTool:w}=(0,T.I)(),{studioName:G}=(0,g.p)(),L=(0,m.T)(async function(){let{description:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var a;let r=(0,h.TK)(t),o=(0,h.vZ)(t),l=(0,v.q6)(t.url.generation),c=l;e&&(c=await (0,f._n)(l,e)),x(c,"".concat((0,E.o)({name:[null==A?void 0:A.name,(0,h.Rs)(t),t.uuid],isUpscaled:o,isVariation:r}),".png"),0,{},{onSuccess:()=>{I("image")}});let d=Number(localStorage.getItem(u.F.GEN_TILL_EXPORT)),m=(0,h.xf)(t),_=(0,h.Bg)(m),p=(0,i.G)(_),g=Number(null!==(a=localStorage.getItem(u.F.TOKENS_CONSUMED))&&void 0!==a?a:0);N.log(s.H0.export.withProperties({export_all:!1,page_name:y,total_images_exported:1,user_account_status:R,user_plan:C,user_plan_period:D,trigger:n,feature:y,email:null==A?void 0:A.email,distinct_id:null==A?void 0:A.id,source:M,tokens_remaining:null==b?void 0:b.total,gen_till_export:d,model_used:null==O?void 0:O.name,prompt_text:p.promptText1,prompt_text_2:p.promptText2,prompt_text_3:p.promptText3,tool_name:w,studio_name:G,tokens_till_export:g})),localStorage.removeItem(u.F.GEN_TILL_EXPORT),localStorage.removeItem(u.F.TOKENS_CONSUMED)}catch(e){(0,r.H)(e),l.ZP.error(e.message)}});return{downloadImage:(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return L.current(e)},[L])}}},80317:function(e,t,n){n.d(t,{dY:function(){return l}});var a=n(7653),r=n(68571);let o=e=>{let{setSize:t,setControllerCallback:n,setPercentageCallback:a,setErrorCallback:r}=e;return e=>{if(!e.ok)throw Error("".concat(e.status," ").concat(e.type," ").concat(e.statusText));if(!e.body)throw Error("ReadableStream not yet supported in this browser.");let o=e.body,i=e.headers.get("content-encoding"),l=parseInt(e.headers.get(i?"x-file-size":"content-length")||"0",10);t(()=>l);let s=0;return new Response(new ReadableStream({start(e){n(e);let t=o.getReader();async function i(){return t.read().then(t=>{let{done:n,value:r}=t;return n?e.close():(s+=(null==r?void 0:r.byteLength)||0,r&&e.enqueue(r),a({loaded:s,total:l}),i())}).catch(n=>(r(n),t.cancel("Cancelled"),e.error(n)))}return i()}}))}},i=(e,t,n)=>{let a=new Blob([e],{type:n||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)return window.navigator.msSaveBlob(a,t);let r=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(a):window.webkitURL.createObjectURL(a),o=document.createElement("a");return o.style.display="none",o.href=r,o.setAttribute("download",t),void 0===o.download&&o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(r)},200)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!1;try{var n;t=!!r&&!!(null==r?void 0:null===(n=r.env)||void 0===n?void 0:n.REACT_APP_DEBUG_MODE)}catch(e){t=!1}let[l,s]=(0,a.useState)(0),[u,c]=(0,a.useState)(0),[d,m]=(0,a.useState)(0),[_,p]=(0,a.useState)(null),[E,g]=(0,a.useState)(!1),T=(0,a.useRef)(null),S=(0,a.useCallback)(e=>{let{loaded:t,total:n}=e,a=Math.round(t/n*100);c(()=>a)},[]),f=(0,a.useCallback)(e=>{let t={"Failed to execute 'enqueue' on 'ReadableStreamDefaultController': Cannot enqueue a chunk into an errored readable stream":"Download canceled","The user aborted a request.":"Download timed out"};p(()=>({errorMessage:t[e.message]||e.message?t[e.message]:e.message}))},[]),v=(0,a.useCallback)(e=>{T.current=e},[]),h=(0,a.useCallback)(()=>{T.current&&T.current.error()},[]),O=(0,a.useCallback)(()=>{v(null),s(()=>0),c(()=>0),m(()=>0),g(()=>!1)},[v]),A=(0,a.useCallback)(async function(n,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4?arguments[4]:void 0;if(E)return null;O(),p(()=>null),g(()=>!0);let c=setInterval(()=>s(e=>e+1),t?1:1e3),d=o({setSize:m,setControllerCallback:v,setPercentageCallback:S,setErrorCallback:f}),_=new AbortController,T=setTimeout(()=>{r>0&&_.abort()},r);return fetch(n,{method:"GET",...e,...l,signal:_.signal,priority:"high"}).then(d).then(e=>e.blob()).then(e=>i(e,a)).then(()=>{var e;return null==u||null===(e=u.onSuccess)||void 0===e||e.call(u),O(),clearInterval(c)}).catch(e=>{var t;return null==u||null===(t=u.onError)||void 0===t||t.call(u),O(),p(t=>{let{message:n}=e;return"Failed to fetch"!==n?{errorMessage:e.message}:t}),clearTimeout(T),clearInterval(c)})},[E,O,t,v,S,f,e]);return(0,a.useMemo)(()=>({elapsed:l,percentage:u,size:d,download:A,cancel:h,error:_,isInProgress:E}),[l,u,d,A,h,_,E])}},48196:function(e,t,n){n.d(t,{h:function(){return o}});var a=n(41179),r=n(7653);let o=()=>{let e=(0,a.useQueryClient)();return{optmisticallyUpdateData:(0,r.useCallback)((t,n)=>e.setQueryData(t,n),[e])}}},21741:function(e,t,n){n.d(t,{X:function(){return _}});var a=n(7653),r=n(41225),o=n(62351);let i=(0,n(57582).Ue)()(e=>({open:!1,type:"image",openModal:t=>e({open:!0,type:t}),closeModal:t=>e({open:!1,type:t}),setModalOpen:(t,n)=>e({open:n,type:t})}));var l=n(36962),s=n(24162),u=n(82633);let c=e=>{let t=Number(localStorage.getItem(e));return Number.isNaN(t)?0:t},d=(e,t)=>{localStorage.setItem(e,t.toString())},m={image:{flagName:o.o.HAS_SEEN_IMAGE_FEEDBACK_MODAL,localStorageKey:r.F.NUM_EXPORTS_IMAGE},video:{flagName:o.o.HAS_SEEN_VIDEO_FEEDBACK_MODAL,localStorageKey:r.F.NUM_EXPORTS_VIDEO}},_=()=>{let{type:e,open:t,openModal:n,closeModal:r}=i(),{mutate:o}=(0,u.yH)(),_=(0,s.T)(m.image.flagName),p=(0,s.T)(m.video.flagName),E=(0,l.Td)()(e=>e.imageDashboard.feedback_modal),g=(0,l.Td)()(e=>e.videoDashboard.feedback_modal),T=(0,a.useMemo)(()=>({image:{...E,hasSeenModal:_},video:{...g,hasSeenModal:p}}),[_,p,E,g]);return{title:T[e].title,description:T[e].description,cta:T[e].cta,isOpen:t,closeModal:()=>r(e),incrementExports:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(T[e].hasSeenModal)return;let{flagName:a,localStorageKey:r}=m[e],i=c(r)+t;d(r,i),i>=T[e].threshold&&(o({name:a,status:!0}),n(e),localStorage.removeItem(r))}}}},28821:function(e,t,n){n.d(t,{o:function(){return a}});let a=e=>{let{name:t,extension:n,isVariation:a=!1,isUpscaled:r=!1}=e,o=t.filter(e=>!!e).map(e=>e.substring(0,65).trim().replace(/ /g,"_")).join("_");return(r&&(o+="_upscaled"),a&&(o+="_variated"),n)?"".concat(o,".").concat(n):o}},20786:function(e,t,n){n.d(t,{F:function(){return m}});var a=n(55854),r=n.n(a),o=n(7653),i=n(94904),l=n(19924),s=n(24995),u=n(33339),c=n(32138),d=n(99319);let m=e=>{let t=(0,i.useUserStoreContext)()(e=>e.user),n=(0,d.O)("textToImage"),a=r()(e,"settings.metadata.remoteConfig.cameraListId",-1),m=r()(e,"settings.metadata.remoteConfig.lightingListId",-1),_=r()(e,"settings.metadata.remoteConfig.modelListId",-1),p=r()(e,"settings.metadata.remoteConfig.styleListId",-1),E=(0,c.ic)(Number(_)),g=(0,c.l$)(Number(p)),T=(0,c.oP)(Number(a)),S=(0,c.yW)(Number(m)),f=(0,u.T)(()=>{var a,r,o;let i=(0,s.xf)(e),u={prompt:null!==(a=(0,s.Rs)(e))&&void 0!==a?a:n.prompt,enhance_prompt:"1"===i.is_enhance,aspect_ratio:null!==(r=i.aspect_ratio)&&void 0!==r?r:n.aspect_ratio,model:null!=E?E:n.model,style:null!=g?g:n.style,lighting:null!=S?S:n.lighting,camera:null!=T?T:n.camera};return(0,l.TE)(u,null!==(o=null==t?void 0:t.name)&&void 0!==o?o:"")});return{getDescription:(0,o.useCallback)(()=>f.current(),[f])}}},65740:function(e,t,n){n.d(t,{M:function(){return i}});var a=n(7653),r=n(75244),o=n(53505);let i=()=>{let e=(0,r.rY)(),t=(0,r.XY)(),{data:n,isLoading:i,isFetching:l,error:s}=e,u=(0,a.useMemo)(()=>{var e,t;return null!==(t=null==n?void 0:null===(e=n.assets)||void 0===e?void 0:e.filter(e=>e.settings.category!==o.Aw.CHARACTER))&&void 0!==t?t:[]},[n]);return{sortedModels:(0,a.useMemo)(()=>[...u].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()),[u]),isLoading:i,isFetching:l,error:s,invalidateGetAllPublicModelsStatusQuery:t}}},13645:function(e,t,n){n.d(t,{b:function(){return T}});var a=n(7653),r=n(94904),o=n(14671),i=n(42636),l=n(57872),s=n(48196),u=n(75244),c=n(43882),d=n(30629),m=n(78293),_=n(66910);let p=async e=>await m.p.post("".concat(_.TG.ASSETS,"/").concat(e,"/favorite"),{headers:{"Content-Type":"multipart/form-data"}},{throwOnError:!0}),E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.useMutation)({mutationFn:e=>p(e),...e})};var g=n(47495);let T=()=>{let e=(0,r.useUserStoreContext)()(e=>e.user),{data:t,isLoading:n,isFetching:d,error:m}=(0,u.zb)(),{optmisticallyUpdateData:_}=(0,s.h)(),p=(0,l.w)(),T=(0,a.useRef)(null),S=!!e,f=(0,a.useMemo)(()=>{var e,n;return null!==(n=null==t?void 0:null===(e=t.assets)||void 0===e?void 0:e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))&&void 0!==n?n:[]},[t]),v=(0,u.k9)(),h=(0,a.useCallback)(e=>{_([c.L.GET_FAVORITE_MODELS_STATUS],t=>{let n={code:e.code,id:e.id,title:e.title,base_id:e.base_id,batch_id:e.batch_id,service:e.service,status:g.l.FINISHED,uuid:e.uuid,created_at:e.created_at,settings:e.settings,url:{generation:e.url.generation,thumbnail:e.url.thumbnail},is_public:e.is_public};if(!t)return{code:"success",response:new Response,data:{status:"success",assets:[n]}};if(t.data.assets.some(e=>e.uuid===n.uuid))return t;let a=[n,...t.data.assets];return{...t,data:{...t.data,assets:a,status:"success"}}})},[_]),O=(0,a.useCallback)(e=>{_([c.L.GET_FAVORITE_MODELS_STATUS],t=>{if(!t)return{code:"success",response:new Response,data:{status:"success",assets:[]}};let n=t.data.assets.filter(t=>t.uuid!==e.uuid);return{...t,data:{...t.data,assets:n}}})},[_]),A=E({onSuccess:()=>{v()},onError:e=>{e instanceof Error?o.ZP.error(e.message):o.ZP.error("Failed to toggle favorite on model.");let t=T.current;t&&(t.isFavorited?h(t.modelData):O(t.modelData))},onSettled:()=>{T.current=null}}),I="loading"===A.status,b=(0,a.useCallback)(e=>f.some(t=>t.uuid===e),[f]);return{favoriteModelsList:f,isLoading:n,isFetching:d,error:m,invalidateGetAllFavoriteModelsStatusQuery:v,checkIfModelIsFavorite:b,toggleFavoritePending:I,handleToggleFavoriteModel:(e,t)=>{if(!S){p({pathname:i.H7.IMAGE_DASHBOARD_TRAIN});return}t?O(e):h(e),T.current={modelData:e,isFavorited:t},A.mutate(e.uuid)}}}},51233:function(e,t,n){n.d(t,{h:function(){return s}});var a=n(7653),r=n(83057),o=n(75244),i=n(47495),l=n(84474);let s=()=>{let e=(0,o.WW)(),t=(0,o.Hz)(),{data:n,isFetching:s,isLoading:u}=e,c=(0,a.useMemo)(()=>{var e,t;return null!==(t=null==n?void 0:null===(e=n.assets)||void 0===e?void 0:e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))&&void 0!==t?t:[]},[n]),{filteredFinishedModels:d}=(0,a.useMemo)(()=>({filteredFinishedModels:c.filter(e=>{let{code:t}=e;return t===i._.FINISHED})}),[c]);return(0,a.useEffect)(()=>{if(!n||!(0,l.Nj)(n.assets))return()=>{};let e=setInterval(()=>{t()},r.mR);return()=>{clearInterval(e)}},[t,n]),{sortedModels:c,filteredFinishedModels:d,isFetching:s,isLoading:u,getAllModelsStatusQuery:e,invalidateGetAllModelsStatusQuery:t}}},75555:function(e,t,n){n.d(t,{p:function(){return i}});var a=n(81695),r=n(7653);let o={IMAGE_STUDIO:"image",VIDEO_STUDIO:"video",SKETCH_STUDIO:"sketch",MUSIC_STUDIO:"music",VOICE_STUDIO:"voice"},i=()=>{let e=(0,a.usePathname)(),t=(null==e?void 0:e.split("/").filter(Boolean))||[],n=Object.values(o),i=t[1]&&n.includes(t[1])?"".concat(t[1],"-studio"):"None";return(0,r.useMemo)(()=>({studioName:i}),[i])}},99319:function(e,t,n){n.d(t,{O:function(){return s}});var a=n(7653),r=n(32138),o=n(36962),i=n(53505),l=n(51997);let s=e=>{let{modelListId:t,styleListId:n,controlListId:s,cameraListId:u,lightingListId:c,...d}=(0,l.m)(e),m=(0,r.ic)(t),_=(0,r.l$)(n),p=(0,r.oP)(u),E=(0,r.yW)(c),g=(0,r.$I)(s),T=(0,o.Td)()(e=>e.textToImageSviImageGuidance);return(0,a.useMemo)(()=>{let e=T[g.parameter];return{...d,model:m,style:_,image_guidance:{...T,mode:g.parameter,modeId:g.id,strength:"strength"in e?e.strength.medium:void 0,image:null,croppedImage:null},should_focus:!1,activeTab:i.V0.IMAGINE,random_prompt_clicked:!1,camera:p,lighting:E}},[p,g.id,T,E,m,_,d,g.parameter])}},71133:function(e,t,n){n.d(t,{I:function(){return c}});var a=n(81695),r=n(7653),o=n(400),i=n(39731),l=n(42636),s=n(65535),u=n(32138);let c=()=>{let e=(0,a.useSearchParams)(),t=(0,a.useSelectedLayoutSegments)(),n=(0,a.usePathname)(),c=n.split("/").pop(),d="None";c===i.S.TEXT_TO_IMAGE?d=i.S.TEXT_TO_IMAGE:c===i.S.TEXT_TO_VIDEO?d=i.S.TEXT_TO_VIDEO:c===i.S.TEXT_TO_SONG?d=i.S.TEXT_TO_SONG:c===i.S.TEXT_TO_SPEECH?d=i.S.TEXT_TO_SPEECH:c===i.S.VOICE_CLONING?d=i.S.VOICE_CLONING:c===i.S.EDITOR&&n.startsWith(l.H7.IMAGE_DASHBOARD)?d=i.S.IMAGE_EDITOR:c===i.S.EDITOR&&n.startsWith(l.H7.VIDEO_DASHBOARD)?d=i.S.VIDEO_EDITOR:t.includes(i.S.TRAIN)&&(d=i.S.TRAIN);let m=e.get(s.xb.TOOL),_=e.get(s.l$.MODEL_LIST_ID),p=e.get(s.l$.INSTRUMENTAL),E=(0,u.ic)(Number(_));return m?d=m:null!==_&&E.enable_layer_diffusion&&(d=o.C.TEXT_TO_PNG),p&&(d=o.C.TEXT_TO_MUSIC),(0,r.useMemo)(()=>({generationTool:d}),[d])}},24162:function(e,t,n){n.d(t,{T:function(){return o}});var a=n(65432);let r=(e,t)=>{var n;return null!==(n=e.get(t))&&void 0!==n&&n},o=e=>{let t=(0,a.UT)()(e=>e.flags);return null!=e&&r(t,e)}},82633:function(e,t,n){n.d(t,{Sk:function(){return S},yH:function(){return f}});var a,r,o,i,l,s=n(965),u=n(30629),c=n(94904),d=n(89226),m=n(64711);let _=(0,n(83632).A)();_["Content-Type"]="application/json";let p=new d.h({baseURL:m.v.FLAGS_API_URL,defaultHeadersGenerator:()=>_});(a=o||(o={})).USER_FLAGS="/user/flags",a.ALL_USER_FLAGS="/user/flags/all",(r=i||(i={})).IMAGINE_WEB="IMAGINE_WEB",r.IMAGINE_ANDROID="IMAGINE_ANDROID",r.IMAGINE_IOS="IMAGINE_IOS";let E=async e=>{let{name:t}=e,{data:n}=await p.get(o.USER_FLAGS,{params:{name:t,platform:i.IMAGINE_WEB},cache:"no-cache"},{throwOnError:!0});return n.result},g=async e=>{let{data:t}=await p.post(o.USER_FLAGS,{body:{...e,platform:i.IMAGINE_WEB}},{throwOnError:!0});return t.result};var T=n(65432);(l||(l={})).USER_FLAGS="UserFlags";let S=e=>{let t=(0,c.useUserStoreContext)()(e=>e.user);return(0,s.useQuery)({queryKey:[l.USER_FLAGS,e],queryFn:()=>E({name:e}),enabled:!!t,staleTime:1/0})},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{shouldUpdateOnSuccess:!0,shouldUpdateOptimistically:!1},{setFlag:t,flagsMap:n}=(0,T.UT)()(e=>({setFlag:e.setFlag,flagsMap:e.flags}));return(0,u.useMutation)({mutationFn:g,onMutate:a=>{let r=n.get(a.name);return e.shouldUpdateOptimistically&&t(a.name,a.status),{prevValue:r}},onSuccess:(n,a)=>{e.shouldUpdateOnSuccess&&!e.shouldUpdateOptimistically&&t(a.name,a.status)},onError:(n,a,r)=>{e.shouldUpdateOptimistically&&(null==r?void 0:r.prevValue)!==void 0&&t(a.name,r.prevValue)}})}},75244:function(e,t,n){n.d(t,{zb:function(){return S},WW:function(){return g},rY:function(){return T},k9:function(){return h},Hz:function(){return f},XY:function(){return v}});var a=n(965),r=n(41179),o=n(7653),i=n(83057),l=n(94904),s=n(66910),u=n(26327);let c=async e=>(0,u.HS)({requestOptions:e,params:{service:s.qb.MODEL}}),d=async()=>(0,u.Yi)({params:{service:s.qb.MODEL}}),m=e=>{let{argEnabled:t=!0,requestOptions:n,service:r}=e,o=!!(0,l.useUserStoreContext)()(e=>e.user),c=(0,a.useQuery)({queryKey:[s.TG.PUBLIC_ASSETS,r,n],queryFn:()=>(0,u.hu)({requestOptions:n,params:{service:r}}),enabled:t&&o,select:e=>null==e?void 0:e.data,staleTime:i.dV}),d=(0,a.useQuery)({queryKey:[s.TG.PUBLIC_UNAUTH_ASSETS,r,n],queryFn:()=>(0,u.V7)({requestOptions:n,params:{service:r}}),enabled:t&&!o,select:e=>null==e?void 0:e.data,staleTime:i.dV});return o?c:d};var _=n(43882);let p={name:"",description:"",category:"style",email:"",gender:"male",user:{name:"",email:""}},E={generation:[],tags:[],thumbnail:[]},g=function(){let{enabled:e=!0,refetchInterval:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.useUserStoreContext)()(e=>e.user);return(0,a.useQuery)({queryKey:[_.L.GET_USERS_MODELS_STATUS],queryFn:async()=>{let e=await c();return e.data.assets=e.data.assets.map(e=>({...e,url:{...E,...e.url},settings:{...p,...e.settings}})),e},refetchInterval:t,enabled:!!n&&e,select:e=>null==e?void 0:e.data,staleTime:i.dV})},T=()=>{let e=m({service:s.qb.MODEL}),{data:t}=e;if(!t)return e;let n=t.assets.map(e=>({...e,url:{...E,...e.url},settings:{...p,...e.settings}}));return{...e,data:{...t,assets:n}}},S=function(){let{enabled:e=!0,refetchInterval:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.useUserStoreContext)()(e=>e.user);return(0,a.useQuery)({queryKey:[_.L.GET_FAVORITE_MODELS_STATUS],queryFn:async()=>{let e=await d();return e.data.assets=e.data.assets.map(e=>({...e,url:{...E,...e.url},settings:{...p,...e.settings}})),e},refetchInterval:t,enabled:!!n&&e,select:e=>null==e?void 0:e.data,staleTime:i.dV})},f=()=>{let e=(0,r.useQueryClient)();return(0,o.useCallback)(()=>{e.invalidateQueries([_.L.GET_USERS_MODELS_STATUS])},[e])},v=()=>{let e=(0,r.useQueryClient)();return(0,o.useCallback)(()=>{e.invalidateQueries([_.L.GET_COMMUNITY_MODELS_STATUS])},[e])},h=()=>{let e=(0,r.useQueryClient)();return(0,o.useCallback)(()=>{e.invalidateQueries([_.L.GET_FAVORITE_MODELS_STATUS])},[e])}},43882:function(e,t,n){var a,r;n.d(t,{L:function(){return a}}),(r=a||(a={})).GET_USERS_MODELS_STATUS="GetUsersModelsStatus",r.GET_COMMUNITY_MODELS_STATUS="GetCommunityModelsStatus",r.GET_FAVORITE_MODELS_STATUS="GetFavoriteModelsStatus"},97336:function(e,t,n){var a,r;n.d(t,{e:function(){return a},v:function(){return o}}),(r=a||(a={})).REIMAGINE="reimagine",r.STRUCTURE="structure",r.FACE="face",r.STYLE="style",r.EDIT="edit";let o=["face","style"]},77440:function(e,t,n){n.d(t,{c4:function(){return i},iR:function(){return l},mr:function(){return o}});var a=n(41270),r=n(72075);let o={PROMPT:"prompt",ASPECT_RATIO:"aspect_ratio",MODEL_LIST_ID:"modelListId",STYLE_LIST_ID:"styleListId",CAMERA_LIST_ID:"cameraListId",LIGHTING_LIST_ID:"lightingListId",ENHANCE_PROMPT:"enhance_prompt",MODEL:"model",STYLE:"style",IMAGE:"image",CROPPED_IMAGE:"croppedImage",SHOULD_FOCUS:"should_focus",RECREATE:"recreate",RANDOM_PROMPT_CLICKED:"random_prompt_clicked"},i=r.SB.omit({supported_aspect_ratios:!0}).extend({is_image_guidance_disabled:a.z.boolean().optional(),inf_time:a.z.number(),effect:a.z.string().optional(),common_supported_aspect_ratios_for_i2v_and_t2v:a.z.string().array(),supported_aspect_ratios_for_t2v:a.z.string().array(),supported_aspect_ratios_for_i2v:a.z.string().array(),should_generate_image_first:a.z.boolean().optional(),image_key:a.z.string().optional(),default_payload:a.z.any().optional(),analytic_name:a.z.string().optional(),default_audio_support:a.z.boolean().optional(),restricted_campaign_id:a.z.number().optional(),analytic_color:a.z.string().optional(),model_type:a.z.string().optional()}),l=a.z.object({model:i,prompt:r.Pp,style:r.Ht,lighting:r.c7,camera:r.c7,aspect_ratio:a.z.string(),enhance_prompt:a.z.boolean().optional().default(!1),image:r.KA.optional(),croppedImage:r.KA.optional(),should_focus:a.z.boolean().optional().default(!1),recreate:a.z.boolean().optional().default(!1),generate_preview:a.z.boolean().optional(),hasHitPromptCaptionApi:a.z.boolean().optional(),random_prompt_clicked:a.z.boolean().optional(),has_uploaded_custom_image:a.z.boolean().optional().default(!1),has_used_image_variation:a.z.boolean().optional().default(!1)})},26327:function(e,t,n){n.d(t,{HB:function(){return _},HS:function(){return m},V7:function(){return E},XF:function(){return p},Yi:function(){return T},hu:function(){return g}});var a=n(51790),r=n.n(a),o=n(75127),i=n.n(o),l=n(24752),s=n(78293),u=n(66910),c=n(30743);let d=e=>{if(e)return new URLSearchParams(i()(e,r()))},m=async e=>{let{requestOptions:t,params:n}=e,a=await s.p.get("".concat(u.TG.ASSETS_STATUS),{...t,params:d(n)},{throwOnError:!0});try{a.data.assets.forEach(e=>{"metadata"in e.settings&&(e.settings.metadata="string"==typeof e.settings.metadata?JSON.parse(e.settings.metadata):e.settings.metadata)})}catch(e){(0,l.H)(e)}return a},_=async e=>{let{assetId:t,params:n}=e;return s.p.get("".concat(u.TG.ASSETS,"/").concat(t).concat(u.TG.STATUS),{params:d(n)},{throwOnError:!0})},p=async e=>{let{requestOptions:t,params:n}=e,a=await s.p.get("".concat(u.TG.ASSETS_STATUS),{...t,params:d({...n,service:u.qb.USER})},{throwOnError:!0});try{a.data.assets.forEach(e=>{"metadata"in e.settings&&(e.settings.metadata="string"==typeof e.settings.metadata?JSON.parse(e.settings.metadata):e.settings.metadata)})}catch(e){(0,l.H)(e)}return a},E=async e=>{let{requestOptions:t,params:n}=e;return s.p.get("".concat(u.TG.PUBLIC_UNAUTH_ASSETS),{...t,params:d(n),headers:{...null==t?void 0:t.headers,...(0,c.getShouldSkipVagAuthInterceptorHeader)(!0)}},{throwOnError:!0})},g=async e=>{let{requestOptions:t,params:n}=e;return s.p.get("".concat(u.TG.PUBLIC_ASSETS),{...t,params:d(n)},{throwOnError:!0})},T=async e=>{let{requestOptions:t,params:n}=e;return s.p.get("".concat(u.TG.FAVORITE_ASSETS),{...t,params:d(n)},{throwOnError:!0})}},47495:function(e,t,n){var a,r,o,i;n.d(t,{_:function(){return a},l:function(){return r}}),(o=a||(a={}))[o.PENDING=0]="PENDING",o[o.PROCESSING=1]="PROCESSING",o[o.FINISHED=2]="FINISHED",o[o.FAILED=-1]="FAILED",(i=r||(r={})).PROCESSING="processing",i.FINISHED="finished",i.ERROR="error"},67613:function(e,t,n){var a,r;n.d(t,{j:function(){return a}}),(r=a||(a={})).IMAGE_ENHANCE="image_enhance",r.IMAGE_VARIATE="image_variate",r.IMAGE_GENERATION="image_generation",r.IMAGE_REMOVE_BG="image_remove_bg"},58016:function(e,t,n){n.d(t,{i_:function(){return d}});var a=n(97336),r=n(39016),o=n(54375),i=n(67728),l=n(66910);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.4;return e?"(".concat(e.trim(),":").concat(t,")"):""},u=(e,t)=>{let n=t.match(/^\w+\s+\w+/),a=t.match(/(\w+\s+\w+)\W*$/);if(!n||!a||!n.length||!a.length)return e;let r=n[0].replace(/^\W+|\W+$/gm,""),o=a[0].replace(/^\W+|\W+$/gm,""),i=e.indexOf(r),l=e.lastIndexOf(o);if(-1===i||-1===l)return e;let u=e.substring(i,l+o.length),c=e.substring(0,i),d=e.substring(l+o.length).replace(/\.$/g,"");return"".concat(s(c),' "').concat(u,'" ').concat(s(d)).trim()},c=async e=>{let t=e.image_guidance.croppedImage,n=e.image_guidance,r=e.image_guidance.mode,o=e.image_guidance.strength,l={};if(!t)return l;if(!r||null==o)throw Error("Invalid control mode or strength mode");switch(r){case a.e.STRUCTURE:{let e=n[r];l.image=await (0,i.K$)(t),l.control_weight=o,l.variation=e.variation;break}case a.e.REIMAGINE:{let e=n[r];l.image=await (0,i.K$)(t),l.variation=e.variation,l.strength=o;break}case a.e.FACE:{let e=n[r];l.image=await (0,i.K$)(t),l.variation=e.variation,l.control_weight=o;break}case a.e.STYLE:{let e=n[r];l.image=await (0,i.K$)(t),l.variation=e.variation,l.control_weight=o;break}case a.e.EDIT:{let e=n[r];l.image=await (0,i.K$)(t),l.variation=e.variation}}return l},d=async(e,t,n)=>{var a,s,d;let m=e.image_guidance.reimagine.image_caption||"",_=u(e.prompt,m),p=(0,l.SN)(_,null===(a=e.model)||void 0===a?void 0:a.init_prompt,null===(s=e.style)||void 0===s?void 0:s.init_prompt),E={prompt:null!=p?p:"",style_id:e.model.model_id,enable_hr:e.model.enable_hr,aspect_ratio:e.aspect_ratio,variation:t,enable_layer_diffusion:!!e.model.enable_layer_diffusion,enable_adetailer:!!e.model.enable_adetailer,is_enhance:e.enhance_prompt?1:0};if(e.style.tag&&(E.enhance_style=e.style.tag),e.lighting.value&&(E.enhance_lighting=e.lighting.value),e.camera.value&&(E.enhance_camera_angle=e.camera.value),e.model.effect&&(E.effect=e.model.effect),t===r.j.IMAGE_TO_IMAGE&&n){let t=await (0,i.K$)(n);return E.denoising_strength=null!==(d=e.denoising_strength)&&void 0!==d?d:.6,E.image=t,(0,o.wh)(E)}let g=await c(e),T={...E,...g};return(0,o.wh)(T)}},66266:function(e,t,n){var a,r;n.d(t,{Z:function(){return a}}),(r=a||(a={})).DASHBOARD="dashboard",r.EXPORT="export"},69517:function(e,t,n){n.d(t,{u:function(){return o}});var a=n(57582),r=n(66266);let o=(0,a.Ue)()(e=>({isOpen:!1,variant:r.Z.DASHBOARD,setIsOpen:(t,n)=>e(()=>({isOpen:t,variant:null!=n?n:r.Z.DASHBOARD}))}))},65432:function(e,t,n){n.d(t,{Ni:function(){return u},UT:function(){return s}});var a=n(27573),r=n(7653),o=n(57582);let i=e=>{let{flags:t}=e,n=t.reduce((e,t)=>(e.set(t.name,t.status),e),new Map);return(0,o.Ue)(e=>({flags:n,setFlag:(t,n)=>{e(e=>{let a=new Map(e.flags);return a.set(t,n),{flags:a}})}}))},l=(0,r.createContext)(null),s=()=>{if(!l)throw Error("useUserBasedFlagsStoreContext must be used within a UserBasedFlagsStoreProvider");return(0,r.useContext)(l)},u=e=>{let{initialState:t,children:n}=e,[o]=(0,r.useState)(()=>i(t));return(0,a.jsx)(l.Provider,{value:o,children:n})}},53505:function(e,t,n){var a,r,o,i,l,s,u,c;n.d(t,{A0:function(){return o},Aw:function(){return a},D5:function(){return m},V0:function(){return i},WS:function(){return _},pQ:function(){return d},r:function(){return p}}),(l=a||(a={})).CHARACTER="character",l.OBJECT="object",l.STYLE="style",(s=r||(r={})).MALE="male",s.FEMALE="female",(u=o||(o={})).TOP_STYLES="top-styles",u.COMMUNITY="community",u.MY_MODELS="my-models",u.FAVOURITES="favourites";let d=[{text:"Top Styles",tab:"top-styles"},{text:"Community Models",tab:"community"},{text:"My Models",tab:"my-models"},{text:"Favourites",tab:"favourites"}],m="top-styles";(c=i||(i={})).TOP_STYLES="top-styles",c.IMAGINE="imagine",c.COMMUNITY="community",c.MY_MODELS="my-models",c.FAVOURITES="favourites";let _=[{text:"Imagine Models",tab:"imagine"},{text:"Top Styles",tab:"top-styles"},{text:"Community Models",tab:"community"},{text:"My Models",tab:"my-models"},{text:"Favourites",tab:"favourites"}],p="community"},86485:function(e,t,n){n.d(t,{KS:function(){return o},VO:function(){return s},in:function(){return i}});var a,r,o,i,l=n(41270);(a=o||(o={})).COMMUNITY="community",a.USER="user",a.FAVORITE="favorite",(r=i||(i={})).ALPHA="alpha",r.BETA="beta";let s=l.z.object({id:l.z.number(),name:l.z.string(),lora_style:l.z.string(),thumbnail:l.z.string(),tag:l.z.string(),description:l.z.string().describe("")})},39016:function(e,t,n){var a,r;n.d(t,{j:function(){return a}}),(r=a||(a={})).TEXT_TO_IMAGE="txt2img",r.IMAGE_TO_IMAGE="img2img"},19924:function(e,t,n){n.d(t,{BB:function(){return _},Nv:function(){return l},TE:function(){return u},XQ:function(){return s},_n:function(){return p},dr:function(){return g},fu:function(){return E}});var a=n(60955),r=n(6788),o=n(89721),i=n(67728);let l={PROMPT:"Prompt",ENHANCE_PROMPT:"EnhancedPrompt",ASPECT_RATIO:"AspectRatio",MODEL_ID:"ModelId",STYLE_ID:"StyleId",LIGHTING_ID:"LightingId",CAMERA_ID:"CameraId",CREATOR:"Creator"},s={[l.PROMPT]:"prompt",[l.ENHANCE_PROMPT]:"enhance_prompt",[l.ASPECT_RATIO]:"aspect_ratio",[l.MODEL_ID]:"model",[l.STYLE_ID]:"style",[l.LIGHTING_ID]:"lighting",[l.CAMERA_ID]:"camera"},u=(e,t)=>{let n=Object.entries({[l.PROMPT]:e.prompt,[l.ENHANCE_PROMPT]:e.enhance_prompt,[l.ASPECT_RATIO]:e.aspect_ratio,[l.MODEL_ID]:e.model.id,[l.STYLE_ID]:e.style.id,[l.LIGHTING_ID]:e.lighting.id,[l.CAMERA_ID]:e.camera.id,[l.CREATOR]:t}).map(e=>{let[t,n]=e;return{key:t,value:n}});return(0,r.P)(n,{header:!1,columns:["key","value"],quoted:!0,delimiter:":",record_delimiter:","})},c=e=>e.startsWith("".concat(l.PROMPT,":")),d=e=>e.split(", ").reduce((e,t)=>{let n=t.indexOf(":");if(-1===n)return e;let a=t.slice(0,n).trim(),r=t.slice(n+1).trim();return e[a]=r,e},{}),m=e=>(0,a.Q)(e,{delimiter:":",quote:'"',record_delimiter:",",columns:["key","value"],skip_empty_lines:!0,relax_column_count:!0,trim:!0}).reduce((e,t)=>{let{key:n,value:a=""}=t;return e[n]=a,e},{}),_=e=>c(e)?d(e):m(e),p=async(e,t)=>{let n;if(e.startsWith("data:image"))n=e;else{let t=await (0,i.PD)(e);if(!t)throw Error("Failed to convert image to PNG Blob");n=await (0,i.tw)(t)}let a=(0,o.addMetadataFromBase64DataURI)(n,"description",t),r=await (0,i.ug)(a);return(0,i.RJ)(r)},E=e=>{let t=(0,i.y9)(e);return(0,o.getMetadata)(t,"description")},g=(e,t)=>e.find(e=>"".concat(e.id)==="".concat(t))},19591:function(e,t,n){n.d(t,{E:function(){return r}});var a=n(47495);let r=new Set([a._.PENDING,a._.PROCESSING])},24995:function(e,t,n){n.d(t,{Bg:function(){return s},Po:function(){return c},Rs:function(){return u},TK:function(){return g},aO:function(){return T},bL:function(){return m},nG:function(){return p},vZ:function(){return E},wz:function(){return _},xf:function(){return l}});var a=n(55854),r=n.n(a),o=n(67613),i=n(66910);let l=e=>{var t,n,a,r,l,s,u;switch(null===(n=e.settings)||void 0===n?void 0:null===(t=n.metadata)||void 0===t?void 0:t.tag){case o.j.IMAGE_ENHANCE:case o.j.IMAGE_REMOVE_BG:return null===(r=e.settings)||void 0===r?void 0:null===(a=r.metadata)||void 0===a?void 0:a.createdFromSettings}switch(e.endpoint){case i.TG.ENHANCE:case i.TG.ENHANCE_ASYNC:case i.TG.BACKGROUND_REMOVER:case i.TG.FREE_BACKGROUND_REMOVER:return null!==(u=null===(s=e.settings)||void 0===s?void 0:null===(l=s.metadata)||void 0===l?void 0:l.createdFromSettings)&&void 0!==u?u:{aspect_ratio:"1:1",prompt:"",style_id:"-1",count:"1",enable_hr:"0"};default:{let{metadata:t,...n}=e.settings;return n}}},s=e=>{var t;return null!==(t=e.enhanced_prompt)&&void 0!==t?t:e.prompt},u=e=>{var t;return r()(null===(t=e.settings)||void 0===t?void 0:t.metadata,"recreateInfo.promptWithoutManipulation","")||r()(e.settings,"prompt","")},c=e=>0===e.length?"":u(e[0]),d=e=>{let{prompt:t}=l(e);return null!=t?t:""},m=e=>0===e.length?"":d(e[0]),_=e=>{var t;return(null===(t=l(e))||void 0===t?void 0:t.enable_layer_diffusion)==="true"},p=e=>0!==e.length&&_(e[0]),E=e=>{var t,n;return(null===(n=e.settings)||void 0===n?void 0:null===(t=n.metadata)||void 0===t?void 0:t.tag)===o.j.IMAGE_ENHANCE||e.endpoint===i.TG.ENHANCE||e.endpoint===i.TG.ENHANCE_ASYNC},g=e=>{var t,n;return(null===(n=e.settings)||void 0===n?void 0:null===(t=n.metadata)||void 0===t?void 0:t.tag)===o.j.IMAGE_VARIATE},T=e=>{var t;return(null===(t=l(e))||void 0===t?void 0:t.aspect_ratio)||"1:1"}},84474:function(e,t,n){n.d(t,{$C:function(){return i},Nj:function(){return l},QJ:function(){return m},Vn:function(){return o},fZ:function(){return d},q6:function(){return c},xN:function(){return u}});var a=n(47495),r=n(19591);let o=e=>e.code===a._.FAILED,i=e=>r.E.has(e.code),l=e=>e.some(e=>i(e)),s=(e,t)=>{if(e.length!==t.length)return;let n=t.reduce((e,t)=>(e.set(t.id,t),e),new Map);return e.find(e=>{var t;let r=e.code,o=null===(t=n.get(e.id))||void 0===t?void 0:t.code;return r!==o&&o===a._.FINISHED})},u=(e,t)=>void 0!==s(e,t),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e&&e.length>t?e[t]:""},d=e=>[e],m=(e,t)=>e&&0!==e.length?Array(t).fill("").map((t,n)=>c(e,n)):Array(t).fill("")},19011:function(e,t,n){n.d(t,{m:function(){return o}});var a=n(26066),r=n(57046);let o=e=>{"true"===a.Z.get(r.b.SHOW_PHOTO_GEN_FORM)&&(window.Tally.openPopup(e,{width:1024,autoClose:0,layout:"modal",overlay:!0}),a.Z.set(r.b.SHOW_PHOTO_GEN_FORM,"false"))}},50499:function(e,t,n){n.d(t,{G:function(){return a}});let a=e=>({promptText1:e.slice(0,255),promptText2:e.slice(255,510),promptText3:e.slice(510)})}}]);