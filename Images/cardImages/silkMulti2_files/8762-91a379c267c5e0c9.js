(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8762],{89721:function(e,t){!function(e){"use strict";function t(e){let t=new DataView(new ArrayBuffer(4));return t.setUint32(0,e),new Uint8Array(t.buffer)}function i(e,t=0,i=e.byteLength){let r="",o=Math.min(i,e.byteLength-t);for(let i=0;i<o;i+=1)r+=String.fromCharCode(e.getUint8(t+i));return r}function r(e){return(new TextEncoder).encode(e)}function o(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.byteLength,0));for(let i=0,r=0;i<e.length;i+=1)t.set(e[i],r),r+=e[i].byteLength;return t}function n(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function s(e){let t=new Uint8Array([137,80,78,71,13,10,26,10]);return!(e.length<t.length)&&n(t).getBigUint64()===n(e).getBigUint64()}let l=[];function a(e,i,a){if(!s(e))throw TypeError("Invalid PNG");if(i.length<1||i.length>79)throw TypeError("Invalid length for key");let f=r("tEXt"),u=r(`${i}\0${a}`),c=t(function(e){if(0===l.length)for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;l[e]=t}return(4294967295^((e,t,i)=>{let r=e;for(let e=0;e<i;e++)r=l[255&(r^t[e])]^r>>>8;return r})(4294967295,e,e.byteLength))>>>0}(o([f,u]))),d=o([t(u.byteLength),f,u,c]),_=16+n(e).getUint32(8)+4;return o([e.subarray(0,_),d,e.subarray(_)])}e.addMetadata=a,e.addMetadataFromBase64DataURI=function(e,t,r){let o="data:image/png;base64,";if("string"!=typeof e||e.substring(0,o.length)!==o)throw TypeError("Invalid PNG as Base64 Data URI");let s=atob(e.substring(o.length)),l=new Uint8Array(s.length);for(let e=0;e<s.length;e+=1)l[e]=s.charCodeAt(e);return o+btoa(i(n(a(l,t,r))))},e.getMetadata=function(e,t){if(!s(e))throw TypeError("Invalid PNG");let r=n(e),o=8;for(;o<r.byteLength;){let e=r.getUint32(o);if(i(r,o+4,4+t.length)===`tEXt${t}`)return i(r,o+4+4+t.length+1,e-t.length-1);o+=e+12}},Object.defineProperty(e,"__esModule",{value:!0})}(t)},33694:function(e,t,i){"use strict";i.d(t,{VY:function(){return G},ck:function(){return F},fC:function(){return U},h4:function(){return z},xz:function(){return Q}});var r=i(7653),o=i(99933),n=i(28787),s=i(94492),l=i(46196),a=i(47178),f=i(78378),u=i(89454),c=i(17321),d=i(21004),_=i(27573),h="Accordion",m=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[g,p,b]=(0,n.B)(h),[y,v]=(0,o.b)(h,[b,u.p_]),I=(0,u.p_)(),O=r.forwardRef((e,t)=>{let{type:i,...r}=e;return(0,_.jsx)(g.Provider,{scope:e.__scopeAccordion,children:"multiple"===i?(0,_.jsx)(A,{...r,ref:t}):(0,_.jsx)(x,{...r,ref:t})})});O.displayName=h;var[w,S]=y(h),[N,E]=y(h,{collapsible:!1}),x=r.forwardRef((e,t)=>{let{value:i,defaultValue:o,onValueChange:n=()=>{},collapsible:s=!1,...l}=e,[f,u]=(0,a.T)({prop:i,defaultProp:o,onChange:n});return(0,_.jsx)(w,{scope:e.__scopeAccordion,value:f?[f]:[],onItemOpen:u,onItemClose:r.useCallback(()=>s&&u(""),[s,u]),children:(0,_.jsx)(N,{scope:e.__scopeAccordion,collapsible:s,children:(0,_.jsx)(D,{...l,ref:t})})})}),A=r.forwardRef((e,t)=>{let{value:i,defaultValue:o,onValueChange:n=()=>{},...s}=e,[l=[],f]=(0,a.T)({prop:i,defaultProp:o,onChange:n}),u=r.useCallback(e=>f(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...t,e]}),[f]),c=r.useCallback(e=>f(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter(t=>t!==e)}),[f]);return(0,_.jsx)(w,{scope:e.__scopeAccordion,value:l,onItemOpen:u,onItemClose:c,children:(0,_.jsx)(N,{scope:e.__scopeAccordion,collapsible:!0,children:(0,_.jsx)(D,{...s,ref:t})})})}),[R,C]=y(h),D=r.forwardRef((e,t)=>{let{__scopeAccordion:i,disabled:o,dir:n,orientation:a="vertical",...u}=e,c=r.useRef(null),h=(0,s.e)(c,t),b=p(i),y="ltr"===(0,d.gm)(n),v=(0,l.M)(e.onKeyDown,e=>{var t;if(!m.includes(e.key))return;let i=e.target,r=b().filter(e=>{var t;return!(null===(t=e.ref.current)||void 0===t?void 0:t.disabled)}),o=r.findIndex(e=>e.ref.current===i),n=r.length;if(-1===o)return;e.preventDefault();let s=o,l=n-1,f=()=>{(s=o+1)>l&&(s=0)},u=()=>{(s=o-1)<0&&(s=l)};switch(e.key){case"Home":s=0;break;case"End":s=l;break;case"ArrowRight":"horizontal"===a&&(y?f():u());break;case"ArrowDown":"vertical"===a&&f();break;case"ArrowLeft":"horizontal"===a&&(y?u():f());break;case"ArrowUp":"vertical"===a&&u()}null===(t=r[s%n].ref.current)||void 0===t||t.focus()});return(0,_.jsx)(R,{scope:i,disabled:o,direction:n,orientation:a,children:(0,_.jsx)(g.Slot,{scope:i,children:(0,_.jsx)(f.WV.div,{...u,"data-orientation":a,ref:h,onKeyDown:o?void 0:v})})})}),$="AccordionItem",[T,L]=y($),q=r.forwardRef((e,t)=>{let{__scopeAccordion:i,value:r,...o}=e,n=C($,i),s=S($,i),l=I(i),a=(0,c.M)(),f=r&&s.value.includes(r)||!1,d=n.disabled||e.disabled;return(0,_.jsx)(T,{scope:i,open:f,disabled:d,triggerId:a,children:(0,_.jsx)(u.fC,{"data-orientation":n.orientation,"data-state":P(f),...l,...o,ref:t,disabled:d,open:f,onOpenChange:e=>{e?s.onItemOpen(r):s.onItemClose(r)}})})});q.displayName=$;var j="AccordionHeader",V=r.forwardRef((e,t)=>{let{__scopeAccordion:i,...r}=e,o=C(h,i),n=L(j,i);return(0,_.jsx)(f.WV.h3,{"data-orientation":o.orientation,"data-state":P(n.open),"data-disabled":n.disabled?"":void 0,...r,ref:t})});V.displayName=j;var k="AccordionTrigger",J=r.forwardRef((e,t)=>{let{__scopeAccordion:i,...r}=e,o=C(h,i),n=L(k,i),s=E(k,i),l=I(i);return(0,_.jsx)(g.ItemSlot,{scope:i,children:(0,_.jsx)(u.xz,{"aria-disabled":n.open&&!s.collapsible||void 0,"data-orientation":o.orientation,id:n.triggerId,...l,...r,ref:t})})});J.displayName=k;var B="AccordionContent",M=r.forwardRef((e,t)=>{let{__scopeAccordion:i,...r}=e,o=C(h,i),n=L(B,i),s=I(i);return(0,_.jsx)(u.VY,{role:"region","aria-labelledby":n.triggerId,"data-orientation":o.orientation,...s,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function P(e){return e?"open":"closed"}M.displayName=B;var U=O,F=q,z=V,Q=J,G=M},60955:function(e,t,i){"use strict";i.d(t,{Q:function(){return g}});var r=i(87376).lW;class o extends Error{constructor(e,t,i,...n){for(let s of(Array.isArray(t)&&(t=t.join(" ").trim()),super(t),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,o),this.code=e,n))for(let e in s){let t=s[e];this[e]=r.isBuffer(t)?t.toString(i.encoding):null==t?t:JSON.parse(JSON.stringify(t))}}}let n=function(e){let t=[];for(let i=0,r=e.length;i<r;i++){let r=e[i];if(null==r||!1===r)t[i]={disabled:!0};else if("string"==typeof r)t[i]={name:r};else{if("object"!=typeof r||null===r||Array.isArray(r))throw new o("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(r)} at position ${i}`]);if("string"!=typeof r.name)throw new o("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",`property "name" is required at position ${i}`,"when column is an object literal"]);t[i]=r}}return t};var s=i(87376).lW;class l{constructor(e=100){this.size=e,this.length=0,this.buf=s.allocUnsafe(e)}prepend(e){if(s.isBuffer(e)){let t=this.length+e.length;if(t>=this.size&&(this.resize(),t>=this.size))throw Error("INVALID_BUFFER_STATE");let i=this.buf;this.buf=s.allocUnsafe(this.size),e.copy(this.buf,0),i.copy(this.buf,e.length),this.length+=e.length}else{let t=this.length++;t===this.size&&this.resize();let i=this.clone();this.buf[0]=e,i.copy(this.buf,1,0,t)}}append(e){let t=this.length++;t===this.size&&this.resize(),this.buf[t]=e}clone(){return s.from(this.buf.slice(0,this.length))}resize(){let e=this.length;this.size=2*this.size;let t=s.allocUnsafe(this.size);this.buf.copy(t,0,0,e),this.buf=t}toString(e){return e?this.buf.slice(0,this.length).toString(e):Uint8Array.prototype.slice.call(this.buf.slice(0,this.length))}toJSON(){return this.toString("utf8")}reset(){this.length=0}}var a=i(87376).lW,f=i(87376).lW;let u=function(e){let t={};for(let i in e)t[i.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})]=e[i];if(void 0===t.encoding||!0===t.encoding)t.encoding="utf8";else if(null===t.encoding||!1===t.encoding)t.encoding=null;else if("string"!=typeof t.encoding&&null!==t.encoding)throw new o("CSV_INVALID_OPTION_ENCODING",["Invalid option encoding:","encoding must be a string or null to return a buffer,",`got ${JSON.stringify(t.encoding)}`],t);if(void 0===t.bom||null===t.bom||!1===t.bom)t.bom=!1;else if(!0!==t.bom)throw new o("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,",`got ${JSON.stringify(t.bom)}`],t);if(t.cast_function=null,void 0===t.cast||null===t.cast||!1===t.cast||""===t.cast)t.cast=void 0;else if("function"==typeof t.cast)t.cast_function=t.cast,t.cast=!0;else if(!0!==t.cast)throw new o("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,",`got ${JSON.stringify(t.cast)}`],t);if(void 0===t.cast_date||null===t.cast_date||!1===t.cast_date||""===t.cast_date)t.cast_date=!1;else if(!0===t.cast_date)t.cast_date=function(e){let t=Date.parse(e);return isNaN(t)?e:new Date(t)};else if("function"!=typeof t.cast_date)throw new o("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,",`got ${JSON.stringify(t.cast_date)}`],t);if(t.cast_first_line_to_header=null,!0===t.columns)t.cast_first_line_to_header=void 0;else if("function"==typeof t.columns)t.cast_first_line_to_header=t.columns,t.columns=!0;else if(Array.isArray(t.columns))t.columns=n(t.columns);else if(void 0===t.columns||null===t.columns||!1===t.columns)t.columns=!1;else throw new o("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an array, a function or true,",`got ${JSON.stringify(t.columns)}`],t);if(void 0===t.group_columns_by_name||null===t.group_columns_by_name||!1===t.group_columns_by_name)t.group_columns_by_name=!1;else if(!0!==t.group_columns_by_name)throw new o("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","expect an boolean,",`got ${JSON.stringify(t.group_columns_by_name)}`],t);else if(!1===t.columns)throw new o("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","the `columns` mode must be activated."],t);if(void 0===t.comment||null===t.comment||!1===t.comment||""===t.comment)t.comment=null;else if("string"==typeof t.comment&&(t.comment=f.from(t.comment,t.encoding)),!f.isBuffer(t.comment))throw new o("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,",`got ${JSON.stringify(t.comment)}`],t);if(void 0===t.comment_no_infix||null===t.comment_no_infix||!1===t.comment_no_infix)t.comment_no_infix=!1;else if(!0!==t.comment_no_infix)throw new o("CSV_INVALID_OPTION_COMMENT",["Invalid option comment_no_infix:","value must be a boolean,",`got ${JSON.stringify(t.comment_no_infix)}`],t);let i=JSON.stringify(t.delimiter);if(Array.isArray(t.delimiter)||(t.delimiter=[t.delimiter]),0===t.delimiter.length)throw new o("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${i}`],t);if(t.delimiter=t.delimiter.map(function(e){if(null==e||!1===e)return f.from(",",t.encoding);if("string"==typeof e&&(e=f.from(e,t.encoding)),!f.isBuffer(e)||0===e.length)throw new o("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${i}`],t);return e}),void 0===t.escape||!0===t.escape?t.escape=f.from('"',t.encoding):"string"==typeof t.escape?t.escape=f.from(t.escape,t.encoding):(null===t.escape||!1===t.escape)&&(t.escape=null),null!==t.escape&&!f.isBuffer(t.escape))throw Error(`Invalid Option: escape must be a buffer, a string or a boolean, got ${JSON.stringify(t.escape)}`);if(void 0===t.from||null===t.from)t.from=1;else if("string"==typeof t.from&&/\d+/.test(t.from)&&(t.from=parseInt(t.from)),Number.isInteger(t.from)){if(t.from<0)throw Error(`Invalid Option: from must be a positive integer, got ${JSON.stringify(e.from)}`)}else throw Error(`Invalid Option: from must be an integer, got ${JSON.stringify(t.from)}`);if(void 0===t.from_line||null===t.from_line)t.from_line=1;else if("string"==typeof t.from_line&&/\d+/.test(t.from_line)&&(t.from_line=parseInt(t.from_line)),Number.isInteger(t.from_line)){if(t.from_line<=0)throw Error(`Invalid Option: from_line must be a positive integer greater than 0, got ${JSON.stringify(e.from_line)}`)}else throw Error(`Invalid Option: from_line must be an integer, got ${JSON.stringify(e.from_line)}`);if(void 0===t.ignore_last_delimiters||null===t.ignore_last_delimiters)t.ignore_last_delimiters=!1;else if("number"==typeof t.ignore_last_delimiters)t.ignore_last_delimiters=Math.floor(t.ignore_last_delimiters),0===t.ignore_last_delimiters&&(t.ignore_last_delimiters=!1);else if("boolean"!=typeof t.ignore_last_delimiters)throw new o("CSV_INVALID_OPTION_IGNORE_LAST_DELIMITERS",["Invalid option `ignore_last_delimiters`:","the value must be a boolean value or an integer,",`got ${JSON.stringify(t.ignore_last_delimiters)}`],t);if(!0===t.ignore_last_delimiters&&!1===t.columns)throw new o("CSV_IGNORE_LAST_DELIMITERS_REQUIRES_COLUMNS",["The option `ignore_last_delimiters`","requires the activation of the `columns` option"],t);if(void 0===t.info||null===t.info||!1===t.info)t.info=!1;else if(!0!==t.info)throw Error(`Invalid Option: info must be true, got ${JSON.stringify(t.info)}`);if(void 0===t.max_record_size||null===t.max_record_size||!1===t.max_record_size)t.max_record_size=0;else if(Number.isInteger(t.max_record_size)&&t.max_record_size>=0);else if("string"==typeof t.max_record_size&&/\d+/.test(t.max_record_size))t.max_record_size=parseInt(t.max_record_size);else throw Error(`Invalid Option: max_record_size must be a positive integer, got ${JSON.stringify(t.max_record_size)}`);if(void 0===t.objname||null===t.objname||!1===t.objname)t.objname=void 0;else if(f.isBuffer(t.objname)){if(0===t.objname.length)throw Error("Invalid Option: objname must be a non empty buffer");null===t.encoding||(t.objname=t.objname.toString(t.encoding))}else if("string"==typeof t.objname){if(0===t.objname.length)throw Error("Invalid Option: objname must be a non empty string")}else if("number"==typeof t.objname);else throw Error(`Invalid Option: objname must be a string or a buffer, got ${t.objname}`);if(void 0!==t.objname){if("number"==typeof t.objname){if(!1!==t.columns)throw Error("Invalid Option: objname index cannot be combined with columns or be defined as a field")}else if(!1===t.columns)throw Error("Invalid Option: objname field must be combined with columns or be defined as an index")}if(void 0===t.on_record||null===t.on_record)t.on_record=void 0;else if("function"!=typeof t.on_record)throw new o("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,",`got ${JSON.stringify(t.on_record)}`],t);if(void 0!==t.on_skip&&null!==t.on_skip&&"function"!=typeof t.on_skip)throw Error(`Invalid Option: on_skip must be a function, got ${JSON.stringify(t.on_skip)}`);if(null===t.quote||!1===t.quote||""===t.quote)t.quote=null;else if(void 0===t.quote||!0===t.quote?t.quote=f.from('"',t.encoding):"string"==typeof t.quote&&(t.quote=f.from(t.quote,t.encoding)),!f.isBuffer(t.quote))throw Error(`Invalid Option: quote must be a buffer or a string, got ${JSON.stringify(t.quote)}`);if(void 0===t.raw||null===t.raw||!1===t.raw)t.raw=!1;else if(!0!==t.raw)throw Error(`Invalid Option: raw must be true, got ${JSON.stringify(t.raw)}`);if(void 0===t.record_delimiter)t.record_delimiter=[];else if("string"==typeof t.record_delimiter||f.isBuffer(t.record_delimiter)){if(0===t.record_delimiter.length)throw new o("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer,",`got ${JSON.stringify(t.record_delimiter)}`],t);t.record_delimiter=[t.record_delimiter]}else if(!Array.isArray(t.record_delimiter))throw new o("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer,",`got ${JSON.stringify(t.record_delimiter)}`],t);if(t.record_delimiter=t.record_delimiter.map(function(e,i){if("string"==typeof e||f.isBuffer(e)){if(0===e.length)throw new o("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer",`at index ${i},`,`got ${JSON.stringify(e)}`],t)}else throw new o("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer",`at index ${i},`,`got ${JSON.stringify(e)}`],t);return"string"==typeof e&&(e=f.from(e,t.encoding)),e}),"boolean"==typeof t.relax_column_count);else if(void 0===t.relax_column_count||null===t.relax_column_count)t.relax_column_count=!1;else throw Error(`Invalid Option: relax_column_count must be a boolean, got ${JSON.stringify(t.relax_column_count)}`);if("boolean"==typeof t.relax_column_count_less);else if(void 0===t.relax_column_count_less||null===t.relax_column_count_less)t.relax_column_count_less=!1;else throw Error(`Invalid Option: relax_column_count_less must be a boolean, got ${JSON.stringify(t.relax_column_count_less)}`);if("boolean"==typeof t.relax_column_count_more);else if(void 0===t.relax_column_count_more||null===t.relax_column_count_more)t.relax_column_count_more=!1;else throw Error(`Invalid Option: relax_column_count_more must be a boolean, got ${JSON.stringify(t.relax_column_count_more)}`);if("boolean"==typeof t.relax_quotes);else if(void 0===t.relax_quotes||null===t.relax_quotes)t.relax_quotes=!1;else throw Error(`Invalid Option: relax_quotes must be a boolean, got ${JSON.stringify(t.relax_quotes)}`);if("boolean"==typeof t.skip_empty_lines);else if(void 0===t.skip_empty_lines||null===t.skip_empty_lines)t.skip_empty_lines=!1;else throw Error(`Invalid Option: skip_empty_lines must be a boolean, got ${JSON.stringify(t.skip_empty_lines)}`);if("boolean"==typeof t.skip_records_with_empty_values);else if(void 0===t.skip_records_with_empty_values||null===t.skip_records_with_empty_values)t.skip_records_with_empty_values=!1;else throw Error(`Invalid Option: skip_records_with_empty_values must be a boolean, got ${JSON.stringify(t.skip_records_with_empty_values)}`);if("boolean"==typeof t.skip_records_with_error);else if(void 0===t.skip_records_with_error||null===t.skip_records_with_error)t.skip_records_with_error=!1;else throw Error(`Invalid Option: skip_records_with_error must be a boolean, got ${JSON.stringify(t.skip_records_with_error)}`);if(void 0===t.rtrim||null===t.rtrim||!1===t.rtrim)t.rtrim=!1;else if(!0!==t.rtrim)throw Error(`Invalid Option: rtrim must be a boolean, got ${JSON.stringify(t.rtrim)}`);if(void 0===t.ltrim||null===t.ltrim||!1===t.ltrim)t.ltrim=!1;else if(!0!==t.ltrim)throw Error(`Invalid Option: ltrim must be a boolean, got ${JSON.stringify(t.ltrim)}`);if(void 0===t.trim||null===t.trim||!1===t.trim)t.trim=!1;else if(!0!==t.trim)throw Error(`Invalid Option: trim must be a boolean, got ${JSON.stringify(t.trim)}`);if(!0===t.trim&&!1!==e.ltrim?t.ltrim=!0:!0!==t.ltrim&&(t.ltrim=!1),!0===t.trim&&!1!==e.rtrim?t.rtrim=!0:!0!==t.rtrim&&(t.rtrim=!1),void 0===t.to||null===t.to)t.to=-1;else if("string"==typeof t.to&&/\d+/.test(t.to)&&(t.to=parseInt(t.to)),Number.isInteger(t.to)){if(t.to<=0)throw Error(`Invalid Option: to must be a positive integer greater than 0, got ${JSON.stringify(e.to)}`)}else throw Error(`Invalid Option: to must be an integer, got ${JSON.stringify(e.to)}`);if(void 0===t.to_line||null===t.to_line)t.to_line=-1;else if("string"==typeof t.to_line&&/\d+/.test(t.to_line)&&(t.to_line=parseInt(t.to_line)),Number.isInteger(t.to_line)){if(t.to_line<=0)throw Error(`Invalid Option: to_line must be a positive integer greater than 0, got ${JSON.stringify(e.to_line)}`)}else throw Error(`Invalid Option: to_line must be an integer, got ${JSON.stringify(e.to_line)}`);return t};var c=i(87376).lW;let d=function(e){return e.every(e=>null==e||e.toString&&""===e.toString().trim())},_={utf8:c.from([239,187,191]),utf16le:c.from([255,254])},h=function(e={}){let t=u(e);return{info:{bytes:0,comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},original_options:e,options:t,state:{bomSkipped:!1,bufBytesStart:0,castField:t.cast_function,commenting:!1,error:void 0,enabled:1===t.from_line,escaping:!1,escapeIsQuote:a.isBuffer(t.escape)&&a.isBuffer(t.quote)&&0===a.compare(t.escape,t.quote),expectedRecordLength:Array.isArray(t.columns)?t.columns.length:void 0,field:new l(20),firstLineToHeaders:t.cast_first_line_to_header,needMoreDataSize:Math.max(null!==t.comment?t.comment.length:0,...t.delimiter.map(e=>e.length),null!==t.quote?t.quote.length:0),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new l(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:0===t.record_delimiter.length?0:Math.max(...t.record_delimiter.map(e=>e.length)),trimChars:[a.from(" ",t.encoding)[0],a.from("	",t.encoding)[0]],wasQuoting:!1,wasRowDelimiter:!1,timchars:[a.from(a.from([13],"utf8").toString(),t.encoding),a.from(a.from([10],"utf8").toString(),t.encoding),a.from(a.from([12],"utf8").toString(),t.encoding),a.from(a.from([32],"utf8").toString(),t.encoding),a.from(a.from([9],"utf8").toString(),t.encoding)]},__needMoreData:function(e,t,i){if(i)return!1;let{encoding:r,escape:o,quote:n}=this.options,{quoting:s,needMoreDataSize:l,recordDelimiterMaxLength:a}=this.state;return t-e-1<Math.max(l,0===a?c.from("\r\n",r).length:a,s?(null===o?0:o.length)+n.length:0,s?n.length+a:0)},parse:function(e,t,i,r){let n,s;let{bom:l,comment_no_infix:a,encoding:f,from_line:d,ltrim:h,max_record_size:m,raw:g,relax_quotes:p,rtrim:b,skip_empty_lines:y,to:v,to_line:I}=this.options,{comment:O,escape:w,quote:S,record_delimiter:N}=this.options,{bomSkipped:E,previousBuf:x,rawBuffer:A,escapeIsQuote:R}=this.state;if(void 0===x){if(void 0===e){r();return}n=e}else n=void 0!==x&&void 0===e?x:c.concat([x,e]);if(!1===E){if(!1===l)this.state.bomSkipped=!0;else if(n.length<3){if(!1===t){this.state.previousBuf=n;return}}else{for(let e in _)if(0===_[e].compare(n,0,_[e].length)){let t=_[e].length;this.state.bufBytesStart+=t,n=n.slice(t),this.options=u({...this.original_options,encoding:e}),{comment:O,escape:w,quote:S}=this.options;break}this.state.bomSkipped=!0}}let C=n.length;for(s=0;s<C&&!this.__needMoreData(s,C,t);s++){if(!0===this.state.wasRowDelimiter&&(this.info.lines++,this.state.wasRowDelimiter=!1),-1!==I&&this.info.lines>I){this.state.stop=!0,r();return}!1===this.state.quoting&&0===N.length&&this.__autoDiscoverRecordDelimiter(n,s)&&(N=this.options.record_delimiter);let e=n[s];if(!0===g&&A.append(e),(13===e||10===e)&&!1===this.state.wasRowDelimiter&&(this.state.wasRowDelimiter=!0),!0===this.state.escaping)this.state.escaping=!1;else{if(null!==w&&!0===this.state.quoting&&this.__isEscape(n,s,e)&&s+w.length<C){if(R){if(this.__isQuote(n,s+w.length)){this.state.escaping=!0,s+=w.length-1;continue}}else{this.state.escaping=!0,s+=w.length-1;continue}}if(!1===this.state.commenting&&this.__isQuote(n,s)){if(!0===this.state.quoting){let t=n[s+S.length],i=b&&this.__isCharTrimable(n,s+S.length),r=null!==O&&this.__compareBytes(O,n,s+S.length,t),l=this.__isDelimiter(n,s+S.length,t),a=0===N.length?this.__autoDiscoverRecordDelimiter(n,s+S.length):this.__isRecordDelimiter(t,n,s+S.length);if(null!==w&&this.__isEscape(n,s,e)&&this.__isQuote(n,s+w.length))s+=w.length-1;else if(!t||l||a||r||i){this.state.quoting=!1,this.state.wasQuoting=!0,s+=S.length-1;continue}else if(!1===p){let e=this.__error(new o("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(t)}"`,`at line ${this.info.lines}`,"instead of delimiter, record delimiter, trimable character","(if activated) or comment"],this.options,this.__infoField()));if(void 0!==e)return e}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(S),s+=S.length-1}else if(0!==this.state.field.length){if(!1===p){let e=this.__infoField(),t=Object.keys(_).map(e=>!!_[e].equals(this.state.field.toString())&&e).filter(Boolean)[0],i=this.__error(new o("INVALID_OPENING_QUOTE",["Invalid Opening Quote:",`a quote is found on field ${JSON.stringify(e.column)} at line ${e.lines}, value is ${JSON.stringify(this.state.field.toString(f))}`,t?`(${t} bom)`:void 0],this.options,e,{field:this.state.field}));if(void 0!==i)return i}}else{this.state.quoting=!0,s+=S.length-1;continue}}if(!1===this.state.quoting){let t=this.__isRecordDelimiter(e,n,s);if(0!==t){if(this.state.commenting&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length)this.info.comment_lines++;else{if(!1===this.state.enabled&&this.info.lines+(!0===this.state.wasRowDelimiter?1:0)>=d){this.state.enabled=!0,this.__resetField(),this.__resetRecord(),s+=t-1;continue}if(!0===y&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length){this.info.empty_lines++,s+=t-1;continue}this.info.bytes=this.state.bufBytesStart+s;let e=this.__onField();if(void 0!==e)return e;this.info.bytes=this.state.bufBytesStart+s+t;let o=this.__onRecord(i);if(void 0!==o)return o;if(-1!==v&&this.info.records>=v){this.state.stop=!0,r();return}}this.state.commenting=!1,s+=t-1;continue}if(this.state.commenting)continue;if(null!==O&&(!1===a||0===this.state.record.length&&0===this.state.field.length)&&0!==this.__compareBytes(O,n,s,e)){this.state.commenting=!0;continue}let o=this.__isDelimiter(n,s,e);if(0!==o){this.info.bytes=this.state.bufBytesStart+s;let e=this.__onField();if(void 0!==e)return e;s+=o-1;continue}}}if(!1===this.state.commenting&&0!==m&&this.state.record_length+this.state.field.length>m)return this.__error(new o("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes",`of ${m}`,`at line ${this.info.lines}`],this.options,this.__infoField()));let t=!1===h||!0===this.state.quoting||0!==this.state.field.length||!this.__isCharTrimable(n,s),l=!1===b||!1===this.state.wasQuoting;if(!0===t&&!0===l)this.state.field.append(e);else{if(!0===b&&!this.__isCharTrimable(n,s))return this.__error(new o("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote",`at line ${this.info.lines}`],this.options,this.__infoField()));!1===t&&(s+=this.__isCharTrimable(n,s)-1);continue}}if(!0===t){if(!0===this.state.quoting){let e=this.__error(new o("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:",`the parsing is finished with an opening quote at line ${this.info.lines}`],this.options,this.__infoField()));if(void 0!==e)return e}else if(!0===this.state.wasQuoting||0!==this.state.record.length||0!==this.state.field.length){this.info.bytes=this.state.bufBytesStart+s;let e=this.__onField();if(void 0!==e)return e;let t=this.__onRecord(i);if(void 0!==t)return t}else!0===this.state.wasRowDelimiter?this.info.empty_lines++:!0===this.state.commenting&&this.info.comment_lines++}else this.state.bufBytesStart+=s,this.state.previousBuf=n.slice(s);!0===this.state.wasRowDelimiter&&(this.info.lines++,this.state.wasRowDelimiter=!1)},__onRecord:function(e){let{columns:t,group_columns_by_name:i,encoding:r,info:n,from:s,relax_column_count:l,relax_column_count_less:a,relax_column_count_more:f,raw:u,skip_records_with_empty_values:c}=this.options,{enabled:_,record:h}=this.state;if(!1===_)return this.__resetRecord();let m=h.length;if(!0===t){if(!0===c&&d(h)){this.__resetRecord();return}return this.__firstLineToColumns(h)}if(!1===t&&0===this.info.records&&(this.state.expectedRecordLength=m),m!==this.state.expectedRecordLength){let e=!1===t?new o("CSV_RECORD_INCONSISTENT_FIELDS_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${m} on line ${this.info.lines}`],this.options,this.__infoField(),{record:h}):new o("CSV_RECORD_INCONSISTENT_COLUMNS",["Invalid Record Length:",`columns length is ${t.length},`,`got ${m} on line ${this.info.lines}`],this.options,this.__infoField(),{record:h});if(!0===l||!0===a&&m<this.state.expectedRecordLength||!0===f&&m>this.state.expectedRecordLength)this.info.invalid_field_length++,this.state.error=e;else{let t=this.__error(e);if(t)return t}}if(!0===c&&d(h)){this.__resetRecord();return}if(!0===this.state.recordHasError){this.__resetRecord(),this.state.recordHasError=!1;return}if(this.info.records++,1===s||this.info.records>=s){let{objname:o}=this.options;if(!1!==t){let s={};for(let e=0,r=h.length;e<r;e++)void 0===t[e]||t[e].disabled||(!0===i&&void 0!==s[t[e].name]?Array.isArray(s[t[e].name])?s[t[e].name]=s[t[e].name].concat(h[e]):s[t[e].name]=[s[t[e].name],h[e]]:s[t[e].name]=h[e]);if(!0===u||!0===n){let t=Object.assign({record:s},!0===u?{raw:this.state.rawBuffer.toString(r)}:{},!0===n?{info:this.__infoRecord()}:{}),i=this.__push(void 0===o?t:[s[o],t],e);if(i)return i}else{let t=this.__push(void 0===o?s:[s[o],s],e);if(t)return t}}else if(!0===u||!0===n){let t=Object.assign({record:h},!0===u?{raw:this.state.rawBuffer.toString(r)}:{},!0===n?{info:this.__infoRecord()}:{}),i=this.__push(void 0===o?t:[h[o],t],e);if(i)return i}else{let t=this.__push(void 0===o?h:[h[o],h],e);if(t)return t}}this.__resetRecord()},__firstLineToColumns:function(e){let{firstLineToHeaders:t}=this.state;try{let i=void 0===t?e:t.call(null,e);if(!Array.isArray(i))return this.__error(new o("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,",`got ${JSON.stringify(i)}`],this.options,this.__infoField(),{headers:i}));let r=n(i);this.state.expectedRecordLength=r.length,this.options.columns=r,this.__resetRecord();return}catch(e){return e}},__resetRecord:function(){!0===this.options.raw&&this.state.rawBuffer.reset(),this.state.error=void 0,this.state.record=[],this.state.record_length=0},__onField:function(){let{cast:e,encoding:t,rtrim:i,max_record_size:r}=this.options,{enabled:o,wasQuoting:n}=this.state;if(!1===o)return this.__resetField();let s=this.state.field.toString(t);if(!0===i&&!1===n&&(s=s.trimRight()),!0===e){let[e,t]=this.__cast(s);if(void 0!==e)return e;s=t}this.state.record.push(s),0!==r&&"string"==typeof s&&(this.state.record_length+=s.length),this.__resetField()},__resetField:function(){this.state.field.reset(),this.state.wasQuoting=!1},__push:function(e,t){let{on_record:i}=this.options;if(void 0!==i){let t=this.__infoRecord();try{e=i.call(null,e,t)}catch(e){return e}if(null==e)return}t(e)},__cast:function(e){let{columns:t,relax_column_count:i}=this.options;if(!0===Array.isArray(t)&&i&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];if(null!==this.state.castField)try{let t=this.__infoField();return[void 0,this.state.castField.call(null,e,t)]}catch(e){return[e]}if(this.__isFloat(e))return[void 0,parseFloat(e)];if(!1!==this.options.cast_date){let t=this.__infoField();return[void 0,this.options.cast_date.call(null,e,t)]}return[void 0,e]},__isCharTrimable:function(e,t){return((e,t)=>{let{timchars:i}=this.state;e:for(let r=0;r<i.length;r++){let o=i[r];for(let i=0;i<o.length;i++)if(o[i]!==e[t+i])continue e;return o.length}return 0})(e,t)},__isFloat:function(e){return e-parseFloat(e)+1>=0},__compareBytes:function(e,t,i,r){if(e[0]!==r)return 0;let o=e.length;for(let r=1;r<o;r++)if(e[r]!==t[i+r])return 0;return o},__isDelimiter:function(e,t,i){let{delimiter:r,ignore_last_delimiters:o}=this.options;if(!0===o&&this.state.record.length===this.options.columns.length-1||!1!==o&&"number"==typeof o&&this.state.record.length===o-1)return 0;e:for(let o=0;o<r.length;o++){let n=r[o];if(n[0]===i){for(let i=1;i<n.length;i++)if(n[i]!==e[t+i])continue e;return n.length}}return 0},__isRecordDelimiter:function(e,t,i){let{record_delimiter:r}=this.options,o=r.length;e:for(let n=0;n<o;n++){let o=r[n],s=o.length;if(o[0]===e){for(let e=1;e<s;e++)if(o[e]!==t[i+e])continue e;return o.length}}return 0},__isEscape:function(e,t,i){let{escape:r}=this.options;if(null===r)return!1;let o=r.length;if(r[0]===i){for(let i=0;i<o;i++)if(r[i]!==e[t+i])return!1;return!0}return!1},__isQuote:function(e,t){let{quote:i}=this.options;if(null===i)return!1;let r=i.length;for(let o=0;o<r;o++)if(i[o]!==e[t+o])return!1;return!0},__autoDiscoverRecordDelimiter:function(e,t){let{encoding:i}=this.options,r=[c.from("\r\n",i),c.from("\n",i),c.from("\r",i)];t:for(let i=0;i<r.length;i++){let o=r[i].length;for(let n=0;n<o;n++)if(r[i][n]!==e[t+n])continue t;return this.options.record_delimiter.push(r[i]),this.state.recordDelimiterMaxLength=r[i].length,r[i].length}return 0},__error:function(e){let{encoding:t,raw:i,skip_records_with_error:r}=this.options,o="string"==typeof e?Error(e):e;if(!r)return o;this.state.recordHasError=!0,void 0!==this.options.on_skip&&this.options.on_skip(o,i?this.state.rawBuffer.toString(t):void 0)},__infoDataSet:function(){return{...this.info,columns:this.options.columns}},__infoRecord:function(){let{columns:e,raw:t,encoding:i}=this.options;return{...this.__infoDataSet(),error:this.state.error,header:!0===e,index:this.state.record.length,raw:t?this.state.rawBuffer.toString(i):void 0}},__infoField:function(){let{columns:e}=this.options,t=Array.isArray(e);return{...this.__infoRecord(),column:!0===t?e.length>this.state.record.length?e[this.state.record.length].name:null:this.state.record.length,quoting:this.state.wasQuoting}}}};var m=i(87376).lW;let g=function(e,t={}){"string"==typeof e&&(e=m.from(e));let i=t&&t.objname?{}:[],r=h(t),o=e=>{void 0===r.options.objname?i.push(e):i[e[0]]=e[1]},n=()=>{},s=r.parse(e,!1,o,n);if(void 0!==s)throw s;let l=r.parse(void 0,!0,o,n);if(void 0!==l)throw l;return i}},6788:function(e,t,i){"use strict";i.d(t,{P:function(){return b}});let r=/\\(\\)?/g,o=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g"),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/,l=function(e){let t=typeof e;return"symbol"===t||"object"===t&&e&&"[object Symbol]"===Object.prototype.toString.call(e)},a=function(e,t){if(Array.isArray(e))return!1;let i=typeof e;return!!("number"===i||"symbol"===i||"boolean"===i||!e||l(e))||s.test(e)||!n.test(e)||null!=t&&e in Object(t)},f=function(e){let t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,i,o,n){let s=e;o?s=n.replace(r,"$1"):i&&(s=i.trim()),t.push(s)}),t},u=function(e){if("string"==typeof e||l(e))return e;let t=`${e}`;return"0"==t&&1/e==-INFINITY?"-0":t},c=function(e,t){var i,r;i=t,r=e;let o=0,n=(t=Array.isArray(i)?i:a(i,r)?[i]:f(i)).length;for(;null!=e&&o<n;)e=e[u(t[o++])];return o&&o===n?e:void 0},d=function(e){if(null==e)return[void 0,void 0];if("object"!=typeof e)return[Error('Invalid option "columns": expect an array or an object')];if(Array.isArray(e)){let t=[];for(let i of e)if("string"==typeof i)t.push({key:i,header:i});else{if("object"!=typeof i||null===i||Array.isArray(i))return[Error("Invalid column definition: expect a string or an object")];if(!i.key)return[Error('Invalid column definition: property "key" is required')];void 0===i.header&&(i.header=i.key),t.push(i)}e=t}else{let t=[];for(let i in e)t.push({key:i,header:e[i]});e=t}return[void 0,e]};var _=i(87376).lW;class h extends Error{constructor(e,t,...i){for(let r of(Array.isArray(t)&&(t=t.join(" ")),super(t),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,h),this.code=e,i))for(let e in r){let t=r[e];this[e]=_.isBuffer(t)?t.toString():null==t?t:JSON.parse(JSON.stringify(t))}}}var m=i(87376).lW;let g=function(e){let t={};for(let i in e)t[i.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})]=e[i];if(void 0===t.bom||null===t.bom||!1===t.bom)t.bom=!1;else if(!0!==t.bom)return[new h("CSV_OPTION_BOOLEAN_INVALID_TYPE",["option `bom` is optional and must be a boolean value,",`got ${JSON.stringify(t.bom)}`])];if(void 0===t.delimiter||null===t.delimiter)t.delimiter=",";else if(m.isBuffer(t.delimiter))t.delimiter=t.delimiter.toString();else if("string"!=typeof t.delimiter)return[new h("CSV_OPTION_DELIMITER_INVALID_TYPE",["option `delimiter` must be a buffer or a string,",`got ${JSON.stringify(t.delimiter)}`])];if(void 0===t.quote||null===t.quote)t.quote='"';else if(!0===t.quote)t.quote='"';else if(!1===t.quote)t.quote="";else if(m.isBuffer(t.quote))t.quote=t.quote.toString();else if("string"!=typeof t.quote)return[new h("CSV_OPTION_QUOTE_INVALID_TYPE",["option `quote` must be a boolean, a buffer or a string,",`got ${JSON.stringify(t.quote)}`])];if((void 0===t.quoted||null===t.quoted)&&(t.quoted=!1),void 0===t.escape_formulas||null===t.escape_formulas)t.escape_formulas=!1;else if("boolean"!=typeof t.escape_formulas)return[new h("CSV_OPTION_ESCAPE_FORMULAS_INVALID_TYPE",["option `escape_formulas` must be a boolean,",`got ${JSON.stringify(t.escape_formulas)}`])];if((void 0===t.quoted_empty||null===t.quoted_empty)&&(t.quoted_empty=void 0),void 0===t.quoted_match||null===t.quoted_match||!1===t.quoted_match?t.quoted_match=null:Array.isArray(t.quoted_match)||(t.quoted_match=[t.quoted_match]),t.quoted_match)for(let e of t.quoted_match){let t="string"==typeof e,i=e instanceof RegExp;if(!t&&!i)return[Error(`Invalid Option: quoted_match must be a string or a regex, got ${JSON.stringify(e)}`)]}if((void 0===t.quoted_string||null===t.quoted_string)&&(t.quoted_string=!1),(void 0===t.eof||null===t.eof)&&(t.eof=!0),void 0===t.escape||null===t.escape)t.escape='"';else if(m.isBuffer(t.escape))t.escape=t.escape.toString();else if("string"!=typeof t.escape)return[Error(`Invalid Option: escape must be a buffer or a string, got ${JSON.stringify(t.escape)}`)];if(t.escape.length>1)return[Error(`Invalid Option: escape must be one character, got ${t.escape.length} characters`)];(void 0===t.header||null===t.header)&&(t.header=!1);let[i,r]=d(t.columns);if(void 0!==i)return[i];if(t.columns=r,(void 0===t.quoted||null===t.quoted)&&(t.quoted=!1),(void 0===t.cast||null===t.cast)&&(t.cast={}),(void 0===t.cast.bigint||null===t.cast.bigint)&&(t.cast.bigint=e=>""+e),(void 0===t.cast.boolean||null===t.cast.boolean)&&(t.cast.boolean=e=>e?"1":""),(void 0===t.cast.date||null===t.cast.date)&&(t.cast.date=e=>""+e.getTime()),(void 0===t.cast.number||null===t.cast.number)&&(t.cast.number=e=>""+e),(void 0===t.cast.object||null===t.cast.object)&&(t.cast.object=e=>JSON.stringify(e)),(void 0===t.cast.string||null===t.cast.string)&&(t.cast.string=function(e){return e}),void 0!==t.on_record&&"function"!=typeof t.on_record)return[Error('Invalid Option: "on_record" must be a function.')];if(void 0===t.record_delimiter||null===t.record_delimiter)t.record_delimiter="\n";else if(m.isBuffer(t.record_delimiter))t.record_delimiter=t.record_delimiter.toString();else if("string"!=typeof t.record_delimiter)return[Error(`Invalid Option: record_delimiter must be a buffer or a string, got ${JSON.stringify(t.record_delimiter)}`)];switch(t.record_delimiter){case"unix":t.record_delimiter="\n";break;case"mac":t.record_delimiter="\r";break;case"windows":t.record_delimiter="\r\n";break;case"ascii":t.record_delimiter="\x1e";break;case"unicode":t.record_delimiter="\u2028"}return[void 0,t]},p=i(87376).lW.from([239,187,191]),b=function(e,t={}){let i=[],[r,o]=g(t);if(void 0!==r)throw r;let n={options:o,state:{stop:!1},info:{records:0},__transform:function(e,t){let i,r;if(!Array.isArray(e)&&"object"!=typeof e)return Error(`Invalid Record: expect an array or an object, got ${JSON.stringify(e)}`);if(0===this.info.records){if(Array.isArray(e)){if(!0===this.options.header&&void 0===this.options.columns)return Error("Undiscoverable Columns: header option requires column option or object records")}else if(void 0===this.options.columns){let[t,i]=d(Object.keys(e));if(t)return;this.options.columns=i}}if(0===this.info.records){this.bom(t);let e=this.headers(t);if(e)return e}try{this.options.on_record&&this.options.on_record(e,this.info.records)}catch(e){return e}if(this.options.eof){if([i,r]=this.stringify(e),i)return i;if(void 0===r)return;r+=this.options.record_delimiter}else{if([i,r]=this.stringify(e),i)return i;if(void 0===r)return;(this.options.header||this.info.records)&&(r=this.options.record_delimiter+r)}this.info.records++,t(r)},stringify:function(e,t=!1){if("object"!=typeof e)return[void 0,e];let{columns:i}=this.options,r=[];if(Array.isArray(e)){i&&e.splice(i.length);for(let i=0;i<e.length;i++){let o=e[i],[n,s]=this.__cast(o,{index:i,column:i,records:this.info.records,header:t});if(n)return[n];r[i]=[s,o]}}else for(let o=0;o<i.length;o++){let n=c(e,i[o].key),[s,l]=this.__cast(n,{index:o,column:i[o].key,records:this.info.records,header:t});if(s)return[s];r[o]=[l,n]}let o="";for(let e=0;e<r.length;e++){let t,i;let[s,l]=r[e];if("string"==typeof s)t=this.options;else{var n;if("object"!=typeof(n=s)||null===n||Array.isArray(n)){if(null!=s)return[Error(`Invalid Casting Value: returned value must return a string, an object, null or undefined, got ${JSON.stringify(s)}`)];t=this.options}else{if(s=(t=s).value,delete t.value,"string"!=typeof s&&null!=s&&i)return[Error(`Invalid Casting Value: returned value must return a string, null or undefined, got ${JSON.stringify(s)}`)];if(t={...this.options,...t},[i,t]=g(t),void 0!==i)return[i]}}let{delimiter:a,escape:f,quote:u,quoted:c,quoted_empty:d,quoted_string:_,quoted_match:h,record_delimiter:m,escape_formulas:p}=t;if(""===s&&""===l){let e=h&&h.filter(e=>"string"==typeof e?-1!==s.indexOf(e):e.test(s));!0===((e=e&&e.length>0)||!0===d||!0===_&&!1!==d)&&(s=u+s+u),o+=s}else if(s){if("string"!=typeof s)return[Error(`Formatter must return a string, null or undefined, got ${JSON.stringify(s)}`)];let e=a.length&&s.indexOf(a)>=0,t=""!==u&&s.indexOf(u)>=0,i=s.indexOf(f)>=0&&f!==u,r=s.indexOf(m)>=0,n=_&&"string"==typeof l,d=h&&h.filter(e=>"string"==typeof e?-1!==s.indexOf(e):e.test(s));if(d=d&&d.length>0,p)switch(s[0]){case"=":case"+":case"-":case"@":case"	":case"\r":case"＝":case"＋":case"－":case"＠":s=`'${s}`}let g=!0===t||e||r||c||n||d;if(!0===g&&!0===i){let e="\\"===f?RegExp(f+f,"g"):RegExp(f,"g");s=s.replace(e,f+f)}if(!0===t){let e=RegExp(u,"g");s=s.replace(e,f+u)}!0===g&&(s=u+s+u),o+=s}else(!0===d||""===l&&!0===_&&!1!==d)&&(o+=u+u);e!==r.length-1&&(o+=a)}return[void 0,o]},bom:function(e){!0===this.options.bom&&e(p)},headers:function(e){let t;if(!1===this.options.header||void 0===this.options.columns)return;let i=this.options.columns.map(e=>e.header);if(this.options.eof?([t,i]=this.stringify(i,!0),i+=this.options.record_delimiter):[t,i]=this.stringify(i),t)return t;e(i)},__cast:function(e,t){let i=typeof e;try{if("string"===i)return[void 0,this.options.cast.string(e,t)];if("bigint"===i)return[void 0,this.options.cast.bigint(e,t)];if("number"===i)return[void 0,this.options.cast.number(e,t)];if("boolean"===i)return[void 0,this.options.cast.boolean(e,t)];else if(e instanceof Date)return[void 0,this.options.cast.date(e,t)];else if("object"===i&&null!==e)return[void 0,this.options.cast.object(e,t)];else return[void 0,e,e]}catch(e){return[e]}}};for(let t of e){let e=n.__transform(t,function(e){i.push(e)});if(void 0!==e)throw e}if(0===i.length){n.bom(e=>{i.push(e)});let e=n.headers(e=>{i.push(e)});if(void 0!==e)throw e}return i.join("")}}}]);